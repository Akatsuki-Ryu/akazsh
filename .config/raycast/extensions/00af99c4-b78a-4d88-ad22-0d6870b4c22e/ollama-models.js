"use strict";var Rs=Object.create;var Pr=Object.defineProperty;var Es=Object.getOwnPropertyDescriptor;var vs=Object.getOwnPropertyNames;var $s=Object.getPrototypeOf,As=Object.prototype.hasOwnProperty;var Ut=(a,r)=>()=>(a&&(r=a(a=0)),r);var _n=(a,r)=>()=>(r||a((r={exports:{}}).exports,r),r.exports),Xa=(a,r)=>{for(var n in r)Pr(a,n,{get:r[n],enumerable:!0})},ei=(a,r,n,o)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of vs(r))!As.call(a,s)&&s!==n&&Pr(a,s,{get:()=>r[s],enumerable:!(o=Es(r,s))||o.enumerable});return a};var ie=(a,r,n)=>(n=a!=null?Rs($s(a)):{},ei(r||!a||!a.__esModule?Pr(n,"default",{value:a,enumerable:!0}):n,a)),Ts=a=>ei(Pr({},"__esModule",{value:!0}),a);var di=_n((Dr,fi)=>{(function(a,r){typeof Dr=="object"&&typeof fi<"u"?r(Dr):typeof define=="function"&&define.amd?define(["exports"],r):(a=typeof globalThis<"u"?globalThis:a||self,r(a.WebStreamsPolyfill={}))})(Dr,(function(a){"use strict";let r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:e=>`Symbol(${e})`;function n(){}function o(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}let s=o();function c(e){return typeof e=="object"&&e!==null||typeof e=="function"}let u=n,d=Promise,h=Promise.prototype.then,m=Promise.resolve.bind(d),A=Promise.reject.bind(d);function E(e){return new d(e)}function _(e){return m(e)}function y(e){return A(e)}function g(e,t,i){return h.call(e,t,i)}function S(e,t,i){g(g(e,t,i),void 0,u)}function O(e,t){S(e,t)}function P(e,t){S(e,void 0,t)}function T(e,t,i){return g(e,t,i)}function M(e){g(e,void 0,u)}let C=(()=>{let e=s&&s.queueMicrotask;if(typeof e=="function")return e;let t=_(void 0);return i=>g(t,i)})();function D(e,t,i){if(typeof e!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,i)}function x(e,t,i){try{return _(D(e,t,i))}catch(l){return y(l)}}let te=16384;class Z{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(t){let i=this._back,l=i;i._elements.length===te-1&&(l={_elements:[],_next:void 0}),i._elements.push(t),l!==i&&(this._back=l,i._next=l),++this._size}shift(){let t=this._front,i=t,l=this._cursor,f=l+1,p=t._elements,b=p[l];return f===te&&(i=t._next,f=0),--this._size,this._cursor=f,t!==i&&(this._front=i),p[l]=void 0,b}forEach(t){let i=this._cursor,l=this._front,f=l._elements;for(;(i!==f.length||l._next!==void 0)&&!(i===f.length&&(l=l._next,f=l._elements,i=0,f.length===0));)t(f[i]),++i}peek(){let t=this._front,i=this._cursor;return t._elements[i]}}function Fe(e,t){e._ownerReadableStream=t,t._reader=e,t._state==="readable"?_e(e):t._state==="closed"?z(e):Te(e,t._storedError)}function v(e,t){let i=e._ownerReadableStream;return ge(i,t)}function q(e){e._ownerReadableStream._state==="readable"?me(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):jr(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function j(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function _e(e){e._closedPromise=E((t,i)=>{e._closedPromise_resolve=t,e._closedPromise_reject=i})}function Te(e,t){_e(e),me(e,t)}function z(e){_e(e),Jt(e)}function me(e,t){e._closedPromise_reject!==void 0&&(M(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function jr(e,t){Te(e,t)}function Jt(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}let Nn=r("[[AbortSteps]]"),zn=r("[[ErrorSteps]]"),Vr=r("[[CancelSteps]]"),Hr=r("[[PullSteps]]"),qn=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)},Zi=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function Xi(e){return typeof e=="object"||typeof e=="function"}function Pe(e,t){if(e!==void 0&&!Xi(e))throw new TypeError(`${t} is not an object.`)}function pe(e,t){if(typeof e!="function")throw new TypeError(`${t} is not a function.`)}function eo(e){return typeof e=="object"&&e!==null||typeof e=="function"}function jn(e,t){if(!eo(e))throw new TypeError(`${t} is not an object.`)}function ke(e,t,i){if(e===void 0)throw new TypeError(`Parameter ${t} is required in '${i}'.`)}function Gr(e,t,i){if(e===void 0)throw new TypeError(`${t} is required in '${i}'.`)}function Yr(e){return Number(e)}function Vn(e){return e===0?0:e}function to(e){return Vn(Zi(e))}function Hn(e,t){let l=Number.MAX_SAFE_INTEGER,f=Number(e);if(f=Vn(f),!qn(f))throw new TypeError(`${t} is not a finite number`);if(f=to(f),f<0||f>l)throw new TypeError(`${t} is outside the accepted range of 0 to ${l}, inclusive`);return!qn(f)||f===0?0:f}function Jr(e,t){if(!ze(e))throw new TypeError(`${t} is not a ReadableStream.`)}function lt(e){return new vt(e)}function Gn(e,t){e._reader._readRequests.push(t)}function Qr(e,t,i){let f=e._reader._readRequests.shift();i?f._closeSteps():f._chunkSteps(t)}function Qt(e){return e._reader._readRequests.length}function Yn(e){let t=e._reader;return!(t===void 0||!Be(t))}class vt{constructor(t){if(ke(t,1,"ReadableStreamDefaultReader"),Jr(t,"First parameter"),qe(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");Fe(this,t),this._readRequests=new Z}get closed(){return Be(this)?this._closedPromise:y(Kt("closed"))}cancel(t=void 0){return Be(this)?this._ownerReadableStream===void 0?y(j("cancel")):v(this,t):y(Kt("cancel"))}read(){if(!Be(this))return y(Kt("read"));if(this._ownerReadableStream===void 0)return y(j("read from"));let t,i,l=E((p,b)=>{t=p,i=b});return $t(this,{_chunkSteps:p=>t({value:p,done:!1}),_closeSteps:()=>t({value:void 0,done:!0}),_errorSteps:p=>i(p)}),l}releaseLock(){if(!Be(this))throw Kt("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");q(this)}}}Object.defineProperties(vt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof r.toStringTag=="symbol"&&Object.defineProperty(vt.prototype,r.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function Be(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_readRequests")?!1:e instanceof vt}function $t(e,t){let i=e._ownerReadableStream;i._disturbed=!0,i._state==="closed"?t._closeSteps():i._state==="errored"?t._errorSteps(i._storedError):i._readableStreamController[Hr](t)}function Kt(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}let Jn=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class Qn{constructor(t,i){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=t,this._preventCancel=i}next(){let t=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?T(this._ongoingPromise,t,t):t(),this._ongoingPromise}return(t){let i=()=>this._returnSteps(t);return this._ongoingPromise?T(this._ongoingPromise,i,i):i()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let t=this._reader;if(t._ownerReadableStream===void 0)return y(j("iterate"));let i,l,f=E((b,R)=>{i=b,l=R});return $t(t,{_chunkSteps:b=>{this._ongoingPromise=void 0,C(()=>i({value:b,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,q(t),i({value:void 0,done:!0})},_errorSteps:b=>{this._ongoingPromise=void 0,this._isFinished=!0,q(t),l(b)}}),f}_returnSteps(t){if(this._isFinished)return Promise.resolve({value:t,done:!0});this._isFinished=!0;let i=this._reader;if(i._ownerReadableStream===void 0)return y(j("finish iterating"));if(!this._preventCancel){let l=v(i,t);return q(i),T(l,()=>({value:t,done:!0}))}return q(i),_({value:t,done:!0})}}let Kn={next(){return Zn(this)?this._asyncIteratorImpl.next():y(Xn("next"))},return(e){return Zn(this)?this._asyncIteratorImpl.return(e):y(Xn("return"))}};Jn!==void 0&&Object.setPrototypeOf(Kn,Jn);function ro(e,t){let i=lt(e),l=new Qn(i,t),f=Object.create(Kn);return f._asyncIteratorImpl=l,f}function Zn(e){if(!c(e)||!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof Qn}catch{return!1}}function Xn(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}let ea=Number.isNaN||function(e){return e!==e};function At(e){return e.slice()}function ta(e,t,i,l,f){new Uint8Array(e).set(new Uint8Array(i,l,f),t)}function ul(e){return e}function Zt(e){return!1}function ra(e,t,i){if(e.slice)return e.slice(t,i);let l=i-t,f=new ArrayBuffer(l);return ta(f,0,e,t,l),f}function no(e){return!(typeof e!="number"||ea(e)||e<0)}function na(e){let t=ra(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(t)}function Kr(e){let t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function Zr(e,t,i){if(!no(i)||i===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:t,size:i}),e._queueTotalSize+=i}function ao(e){return e._queue.peek().value}function Ue(e){e._queue=new Z,e._queueTotalSize=0}class Tt{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!Xr(this))throw nn("view");return this._view}respond(t){if(!Xr(this))throw nn("respond");if(ke(t,1,"respond"),t=Hn(t,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");Zt(this._view.buffer),nr(this._associatedReadableByteStreamController,t)}respondWithNewView(t){if(!Xr(this))throw nn("respondWithNewView");if(ke(t,1,"respondWithNewView"),!ArrayBuffer.isView(t))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");Zt(t.buffer),ar(this._associatedReadableByteStreamController,t)}}Object.defineProperties(Tt.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),typeof r.toStringTag=="symbol"&&Object.defineProperty(Tt.prototype,r.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class ct{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!Ge(this))throw kt("byobRequest");return rn(this)}get desiredSize(){if(!Ge(this))throw kt("desiredSize");return fa(this)}close(){if(!Ge(this))throw kt("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let t=this._controlledReadableByteStream._state;if(t!=="readable")throw new TypeError(`The stream (in ${t} state) is not in the readable state and cannot be closed`);Pt(this)}enqueue(t){if(!Ge(this))throw kt("enqueue");if(ke(t,1,"enqueue"),!ArrayBuffer.isView(t))throw new TypeError("chunk must be an array buffer view");if(t.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(t.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let i=this._controlledReadableByteStream._state;if(i!=="readable")throw new TypeError(`The stream (in ${i} state) is not in the readable state and cannot be enqueued to`);rr(this,t)}error(t=void 0){if(!Ge(this))throw kt("error");be(this,t)}[Vr](t){aa(this),Ue(this);let i=this._cancelAlgorithm(t);return tr(this),i}[Hr](t){let i=this._controlledReadableByteStream;if(this._queueTotalSize>0){let f=this._queue.shift();this._queueTotalSize-=f.byteLength,la(this);let p=new Uint8Array(f.buffer,f.byteOffset,f.byteLength);t._chunkSteps(p);return}let l=this._autoAllocateChunkSize;if(l!==void 0){let f;try{f=new ArrayBuffer(l)}catch(b){t._errorSteps(b);return}let p={buffer:f,bufferByteLength:l,byteOffset:0,byteLength:l,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(p)}Gn(i,t),Ye(this)}}Object.defineProperties(ct.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof r.toStringTag=="symbol"&&Object.defineProperty(ct.prototype,r.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function Ge(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")?!1:e instanceof ct}function Xr(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")?!1:e instanceof Tt}function Ye(e){if(!lo(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let i=e._pullAlgorithm();S(i,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Ye(e))},l=>{be(e,l)})}function aa(e){tn(e),e._pendingPullIntos=new Z}function en(e,t){let i=!1;e._state==="closed"&&(i=!0);let l=ia(t);t.readerType==="default"?Qr(e,l,i):fo(e,l,i)}function ia(e){let t=e.bytesFilled,i=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,t/i)}function Xt(e,t,i,l){e._queue.push({buffer:t,byteOffset:i,byteLength:l}),e._queueTotalSize+=l}function oa(e,t){let i=t.elementSize,l=t.bytesFilled-t.bytesFilled%i,f=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),p=t.bytesFilled+f,b=p-p%i,R=f,I=!1;b>l&&(R=b-t.bytesFilled,I=!0);let F=e._queue;for(;R>0;){let U=F.peek(),W=Math.min(R,U.byteLength),J=t.byteOffset+t.bytesFilled;ta(t.buffer,J,U.buffer,U.byteOffset,W),U.byteLength===W?F.shift():(U.byteOffset+=W,U.byteLength-=W),e._queueTotalSize-=W,sa(e,W,t),R-=W}return I}function sa(e,t,i){i.bytesFilled+=t}function la(e){e._queueTotalSize===0&&e._closeRequested?(tr(e),Ft(e._controlledReadableByteStream)):Ye(e)}function tn(e){e._byobRequest!==null&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function ca(e){for(;e._pendingPullIntos.length>0;){if(e._queueTotalSize===0)return;let t=e._pendingPullIntos.peek();oa(e,t)&&(er(e),en(e._controlledReadableByteStream,t))}}function io(e,t,i){let l=e._controlledReadableByteStream,f=1;t.constructor!==DataView&&(f=t.constructor.BYTES_PER_ELEMENT);let p=t.constructor,b=t.buffer,R={buffer:b,bufferByteLength:b.byteLength,byteOffset:t.byteOffset,byteLength:t.byteLength,bytesFilled:0,elementSize:f,viewConstructor:p,readerType:"byob"};if(e._pendingPullIntos.length>0){e._pendingPullIntos.push(R),ma(l,i);return}if(l._state==="closed"){let I=new p(R.buffer,R.byteOffset,0);i._closeSteps(I);return}if(e._queueTotalSize>0){if(oa(e,R)){let I=ia(R);la(e),i._chunkSteps(I);return}if(e._closeRequested){let I=new TypeError("Insufficient bytes to fill elements in the given buffer");be(e,I),i._errorSteps(I);return}}e._pendingPullIntos.push(R),ma(l,i),Ye(e)}function oo(e,t){let i=e._controlledReadableByteStream;if(an(i))for(;pa(i)>0;){let l=er(e);en(i,l)}}function so(e,t,i){if(sa(e,t,i),i.bytesFilled<i.elementSize)return;er(e);let l=i.bytesFilled%i.elementSize;if(l>0){let f=i.byteOffset+i.bytesFilled,p=ra(i.buffer,f-l,f);Xt(e,p,0,p.byteLength)}i.bytesFilled-=l,en(e._controlledReadableByteStream,i),ca(e)}function ua(e,t){let i=e._pendingPullIntos.peek();tn(e),e._controlledReadableByteStream._state==="closed"?oo(e):so(e,t,i),Ye(e)}function er(e){return e._pendingPullIntos.shift()}function lo(e){let t=e._controlledReadableByteStream;return t._state!=="readable"||e._closeRequested||!e._started?!1:!!(Yn(t)&&Qt(t)>0||an(t)&&pa(t)>0||fa(e)>0)}function tr(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function Pt(e){let t=e._controlledReadableByteStream;if(!(e._closeRequested||t._state!=="readable")){if(e._queueTotalSize>0){e._closeRequested=!0;return}if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){let l=new TypeError("Insufficient bytes to fill elements in the given buffer");throw be(e,l),l}tr(e),Ft(t)}}function rr(e,t){let i=e._controlledReadableByteStream;if(e._closeRequested||i._state!=="readable")return;let l=t.buffer,f=t.byteOffset,p=t.byteLength,b=l;if(e._pendingPullIntos.length>0){let R=e._pendingPullIntos.peek();Zt(R.buffer),R.buffer=R.buffer}if(tn(e),Yn(i))if(Qt(i)===0)Xt(e,b,f,p);else{e._pendingPullIntos.length>0&&er(e);let R=new Uint8Array(b,f,p);Qr(i,R,!1)}else an(i)?(Xt(e,b,f,p),ca(e)):Xt(e,b,f,p);Ye(e)}function be(e,t){let i=e._controlledReadableByteStream;i._state==="readable"&&(aa(e),Ue(e),tr(e),Ua(i,t))}function rn(e){if(e._byobRequest===null&&e._pendingPullIntos.length>0){let t=e._pendingPullIntos.peek(),i=new Uint8Array(t.buffer,t.byteOffset+t.bytesFilled,t.byteLength-t.bytesFilled),l=Object.create(Tt.prototype);uo(l,e,i),e._byobRequest=l}return e._byobRequest}function fa(e){let t=e._controlledReadableByteStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function nr(e,t){let i=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(t!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(t===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(i.bytesFilled+t>i.byteLength)throw new RangeError("bytesWritten out of range")}i.buffer=i.buffer,ua(e,t)}function ar(e,t){let i=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(t.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(t.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(i.byteOffset+i.bytesFilled!==t.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(i.bufferByteLength!==t.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(i.bytesFilled+t.byteLength>i.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");let f=t.byteLength;i.buffer=t.buffer,ua(e,f)}function da(e,t,i,l,f,p,b){t._controlledReadableByteStream=e,t._pullAgain=!1,t._pulling=!1,t._byobRequest=null,t._queue=t._queueTotalSize=void 0,Ue(t),t._closeRequested=!1,t._started=!1,t._strategyHWM=p,t._pullAlgorithm=l,t._cancelAlgorithm=f,t._autoAllocateChunkSize=b,t._pendingPullIntos=new Z,e._readableStreamController=t;let R=i();S(_(R),()=>{t._started=!0,Ye(t)},I=>{be(t,I)})}function co(e,t,i){let l=Object.create(ct.prototype),f=()=>{},p=()=>_(void 0),b=()=>_(void 0);t.start!==void 0&&(f=()=>t.start(l)),t.pull!==void 0&&(p=()=>t.pull(l)),t.cancel!==void 0&&(b=I=>t.cancel(I));let R=t.autoAllocateChunkSize;if(R===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");da(e,l,f,p,b,i,R)}function uo(e,t,i){e._associatedReadableByteStreamController=t,e._view=i}function nn(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function kt(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function ha(e){return new Ct(e)}function ma(e,t){e._reader._readIntoRequests.push(t)}function fo(e,t,i){let f=e._reader._readIntoRequests.shift();i?f._closeSteps(t):f._chunkSteps(t)}function pa(e){return e._reader._readIntoRequests.length}function an(e){let t=e._reader;return!(t===void 0||!Je(t))}class Ct{constructor(t){if(ke(t,1,"ReadableStreamBYOBReader"),Jr(t,"First parameter"),qe(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!Ge(t._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");Fe(this,t),this._readIntoRequests=new Z}get closed(){return Je(this)?this._closedPromise:y(ir("closed"))}cancel(t=void 0){return Je(this)?this._ownerReadableStream===void 0?y(j("cancel")):v(this,t):y(ir("cancel"))}read(t){if(!Je(this))return y(ir("read"));if(!ArrayBuffer.isView(t))return y(new TypeError("view must be an array buffer view"));if(t.byteLength===0)return y(new TypeError("view must have non-zero byteLength"));if(t.buffer.byteLength===0)return y(new TypeError("view's buffer must have non-zero byteLength"));if(Zt(t.buffer),this._ownerReadableStream===void 0)return y(j("read from"));let i,l,f=E((b,R)=>{i=b,l=R});return ba(this,t,{_chunkSteps:b=>i({value:b,done:!1}),_closeSteps:b=>i({value:b,done:!0}),_errorSteps:b=>l(b)}),f}releaseLock(){if(!Je(this))throw ir("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");q(this)}}}Object.defineProperties(Ct.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof r.toStringTag=="symbol"&&Object.defineProperty(Ct.prototype,r.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function Je(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")?!1:e instanceof Ct}function ba(e,t,i){let l=e._ownerReadableStream;l._disturbed=!0,l._state==="errored"?i._errorSteps(l._storedError):io(l._readableStreamController,t,i)}function ir(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function Ot(e,t){let{highWaterMark:i}=e;if(i===void 0)return t;if(ea(i)||i<0)throw new RangeError("Invalid highWaterMark");return i}function or(e){let{size:t}=e;return t||(()=>1)}function sr(e,t){Pe(e,t);let i=e?.highWaterMark,l=e?.size;return{highWaterMark:i===void 0?void 0:Yr(i),size:l===void 0?void 0:ho(l,`${t} has member 'size' that`)}}function ho(e,t){return pe(e,t),i=>Yr(e(i))}function mo(e,t){Pe(e,t);let i=e?.abort,l=e?.close,f=e?.start,p=e?.type,b=e?.write;return{abort:i===void 0?void 0:po(i,e,`${t} has member 'abort' that`),close:l===void 0?void 0:bo(l,e,`${t} has member 'close' that`),start:f===void 0?void 0:go(f,e,`${t} has member 'start' that`),write:b===void 0?void 0:yo(b,e,`${t} has member 'write' that`),type:p}}function po(e,t,i){return pe(e,i),l=>x(e,t,[l])}function bo(e,t,i){return pe(e,i),()=>x(e,t,[])}function go(e,t,i){return pe(e,i),l=>D(e,t,[l])}function yo(e,t,i){return pe(e,i),(l,f)=>x(e,t,[l,f])}function ga(e,t){if(!ut(e))throw new TypeError(`${t} is not a WritableStream.`)}function wo(e){if(typeof e!="object"||e===null)return!1;try{return typeof e.aborted=="boolean"}catch{return!1}}let So=typeof AbortController=="function";function _o(){if(So)return new AbortController}class xt{constructor(t={},i={}){t===void 0?t=null:jn(t,"First parameter");let l=sr(i,"Second parameter"),f=mo(t,"First parameter");if(wa(this),f.type!==void 0)throw new RangeError("Invalid type is specified");let b=or(l),R=Ot(l,1);Mo(this,f,R,b)}get locked(){if(!ut(this))throw dr("locked");return ft(this)}abort(t=void 0){return ut(this)?ft(this)?y(new TypeError("Cannot abort a stream that already has a writer")):lr(this,t):y(dr("abort"))}close(){return ut(this)?ft(this)?y(new TypeError("Cannot close a stream that already has a writer")):Re(this)?y(new TypeError("Cannot close an already-closing stream")):Sa(this):y(dr("close"))}getWriter(){if(!ut(this))throw dr("getWriter");return ya(this)}}Object.defineProperties(xt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),typeof r.toStringTag=="symbol"&&Object.defineProperty(xt.prototype,r.toStringTag,{value:"WritableStream",configurable:!0});function ya(e){return new It(e)}function Ro(e,t,i,l,f=1,p=()=>1){let b=Object.create(xt.prototype);wa(b);let R=Object.create(dt.prototype);return Aa(b,R,e,t,i,l,f,p),b}function wa(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new Z,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function ut(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")?!1:e instanceof xt}function ft(e){return e._writer!==void 0}function lr(e,t){var i;if(e._state==="closed"||e._state==="errored")return _(void 0);e._writableStreamController._abortReason=t,(i=e._writableStreamController._abortController)===null||i===void 0||i.abort();let l=e._state;if(l==="closed"||l==="errored")return _(void 0);if(e._pendingAbortRequest!==void 0)return e._pendingAbortRequest._promise;let f=!1;l==="erroring"&&(f=!0,t=void 0);let p=E((b,R)=>{e._pendingAbortRequest={_promise:void 0,_resolve:b,_reject:R,_reason:t,_wasAlreadyErroring:f}});return e._pendingAbortRequest._promise=p,f||sn(e,t),p}function Sa(e){let t=e._state;if(t==="closed"||t==="errored")return y(new TypeError(`The stream (in ${t} state) is not in the writable state and cannot be closed`));let i=E((f,p)=>{let b={_resolve:f,_reject:p};e._closeRequest=b}),l=e._writer;return l!==void 0&&e._backpressure&&t==="writable"&&bn(l),Lo(e._writableStreamController),i}function Eo(e){return E((i,l)=>{let f={_resolve:i,_reject:l};e._writeRequests.push(f)})}function on(e,t){if(e._state==="writable"){sn(e,t);return}ln(e)}function sn(e,t){let i=e._writableStreamController;e._state="erroring",e._storedError=t;let l=e._writer;l!==void 0&&Ra(l,t),!Po(e)&&i._started&&ln(e)}function ln(e){e._state="errored",e._writableStreamController[zn]();let t=e._storedError;if(e._writeRequests.forEach(f=>{f._reject(t)}),e._writeRequests=new Z,e._pendingAbortRequest===void 0){cr(e);return}let i=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,i._wasAlreadyErroring){i._reject(t),cr(e);return}let l=e._writableStreamController[Nn](i._reason);S(l,()=>{i._resolve(),cr(e)},f=>{i._reject(f),cr(e)})}function vo(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}function $o(e,t){e._inFlightWriteRequest._reject(t),e._inFlightWriteRequest=void 0,on(e,t)}function Ao(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,e._state==="erroring"&&(e._storedError=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";let i=e._writer;i!==void 0&&Ca(i)}function To(e,t){e._inFlightCloseRequest._reject(t),e._inFlightCloseRequest=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._reject(t),e._pendingAbortRequest=void 0),on(e,t)}function Re(e){return!(e._closeRequest===void 0&&e._inFlightCloseRequest===void 0)}function Po(e){return!(e._inFlightWriteRequest===void 0&&e._inFlightCloseRequest===void 0)}function ko(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0}function Co(e){e._inFlightWriteRequest=e._writeRequests.shift()}function cr(e){e._closeRequest!==void 0&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);let t=e._writer;t!==void 0&&mn(t,e._storedError)}function cn(e,t){let i=e._writer;i!==void 0&&t!==e._backpressure&&(t?qo(i):bn(i)),e._backpressure=t}class It{constructor(t){if(ke(t,1,"WritableStreamDefaultWriter"),ga(t,"First parameter"),ft(t))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=t,t._writer=this;let i=t._state;if(i==="writable")!Re(t)&&t._backpressure?mr(this):Oa(this),hr(this);else if(i==="erroring")pn(this,t._storedError),hr(this);else if(i==="closed")Oa(this),No(this);else{let l=t._storedError;pn(this,l),ka(this,l)}}get closed(){return Qe(this)?this._closedPromise:y(Ke("closed"))}get desiredSize(){if(!Qe(this))throw Ke("desiredSize");if(this._ownerWritableStream===void 0)throw Dt("desiredSize");return Do(this)}get ready(){return Qe(this)?this._readyPromise:y(Ke("ready"))}abort(t=void 0){return Qe(this)?this._ownerWritableStream===void 0?y(Dt("abort")):Oo(this,t):y(Ke("abort"))}close(){if(!Qe(this))return y(Ke("close"));let t=this._ownerWritableStream;return t===void 0?y(Dt("close")):Re(t)?y(new TypeError("Cannot close an already-closing stream")):_a(this)}releaseLock(){if(!Qe(this))throw Ke("releaseLock");this._ownerWritableStream!==void 0&&Ea(this)}write(t=void 0){return Qe(this)?this._ownerWritableStream===void 0?y(Dt("write to")):va(this,t):y(Ke("write"))}}Object.defineProperties(It.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),typeof r.toStringTag=="symbol"&&Object.defineProperty(It.prototype,r.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function Qe(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")?!1:e instanceof It}function Oo(e,t){let i=e._ownerWritableStream;return lr(i,t)}function _a(e){let t=e._ownerWritableStream;return Sa(t)}function xo(e){let t=e._ownerWritableStream,i=t._state;return Re(t)||i==="closed"?_(void 0):i==="errored"?y(t._storedError):_a(e)}function Io(e,t){e._closedPromiseState==="pending"?mn(e,t):zo(e,t)}function Ra(e,t){e._readyPromiseState==="pending"?xa(e,t):jo(e,t)}function Do(e){let t=e._ownerWritableStream,i=t._state;return i==="errored"||i==="erroring"?null:i==="closed"?0:Ta(t._writableStreamController)}function Ea(e){let t=e._ownerWritableStream,i=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");Ra(e,i),Io(e,i),t._writer=void 0,e._ownerWritableStream=void 0}function va(e,t){let i=e._ownerWritableStream,l=i._writableStreamController,f=Fo(l,t);if(i!==e._ownerWritableStream)return y(Dt("write to"));let p=i._state;if(p==="errored")return y(i._storedError);if(Re(i)||p==="closed")return y(new TypeError("The stream is closing or closed and cannot be written to"));if(p==="erroring")return y(i._storedError);let b=Eo(i);return Bo(l,t,f),b}let $a={};class dt{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!un(this))throw hn("abortReason");return this._abortReason}get signal(){if(!un(this))throw hn("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(t=void 0){if(!un(this))throw hn("error");this._controlledWritableStream._state==="writable"&&Pa(this,t)}[Nn](t){let i=this._abortAlgorithm(t);return ur(this),i}[zn](){Ue(this)}}Object.defineProperties(dt.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof r.toStringTag=="symbol"&&Object.defineProperty(dt.prototype,r.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function un(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")?!1:e instanceof dt}function Aa(e,t,i,l,f,p,b,R){t._controlledWritableStream=e,e._writableStreamController=t,t._queue=void 0,t._queueTotalSize=void 0,Ue(t),t._abortReason=void 0,t._abortController=_o(),t._started=!1,t._strategySizeAlgorithm=R,t._strategyHWM=b,t._writeAlgorithm=l,t._closeAlgorithm=f,t._abortAlgorithm=p;let I=dn(t);cn(e,I);let F=i(),U=_(F);S(U,()=>{t._started=!0,fr(t)},W=>{t._started=!0,on(e,W)})}function Mo(e,t,i,l){let f=Object.create(dt.prototype),p=()=>{},b=()=>_(void 0),R=()=>_(void 0),I=()=>_(void 0);t.start!==void 0&&(p=()=>t.start(f)),t.write!==void 0&&(b=F=>t.write(F,f)),t.close!==void 0&&(R=()=>t.close()),t.abort!==void 0&&(I=F=>t.abort(F)),Aa(e,f,p,b,R,I,i,l)}function ur(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Lo(e){Zr(e,$a,0),fr(e)}function Fo(e,t){try{return e._strategySizeAlgorithm(t)}catch(i){return fn(e,i),1}}function Ta(e){return e._strategyHWM-e._queueTotalSize}function Bo(e,t,i){try{Zr(e,t,i)}catch(f){fn(e,f);return}let l=e._controlledWritableStream;if(!Re(l)&&l._state==="writable"){let f=dn(e);cn(l,f)}fr(e)}function fr(e){let t=e._controlledWritableStream;if(!e._started||t._inFlightWriteRequest!==void 0)return;if(t._state==="erroring"){ln(t);return}if(e._queue.length===0)return;let l=ao(e);l===$a?Uo(e):Wo(e,l)}function fn(e,t){e._controlledWritableStream._state==="writable"&&Pa(e,t)}function Uo(e){let t=e._controlledWritableStream;ko(t),Kr(e);let i=e._closeAlgorithm();ur(e),S(i,()=>{Ao(t)},l=>{To(t,l)})}function Wo(e,t){let i=e._controlledWritableStream;Co(i);let l=e._writeAlgorithm(t);S(l,()=>{vo(i);let f=i._state;if(Kr(e),!Re(i)&&f==="writable"){let p=dn(e);cn(i,p)}fr(e)},f=>{i._state==="writable"&&ur(e),$o(i,f)})}function dn(e){return Ta(e)<=0}function Pa(e,t){let i=e._controlledWritableStream;ur(e),sn(i,t)}function dr(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function hn(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function Ke(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function Dt(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function hr(e){e._closedPromise=E((t,i)=>{e._closedPromise_resolve=t,e._closedPromise_reject=i,e._closedPromiseState="pending"})}function ka(e,t){hr(e),mn(e,t)}function No(e){hr(e),Ca(e)}function mn(e,t){e._closedPromise_reject!==void 0&&(M(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function zo(e,t){ka(e,t)}function Ca(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function mr(e){e._readyPromise=E((t,i)=>{e._readyPromise_resolve=t,e._readyPromise_reject=i}),e._readyPromiseState="pending"}function pn(e,t){mr(e),xa(e,t)}function Oa(e){mr(e),bn(e)}function xa(e,t){e._readyPromise_reject!==void 0&&(M(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function qo(e){mr(e)}function jo(e,t){pn(e,t)}function bn(e){e._readyPromise_resolve!==void 0&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}let Ia=typeof DOMException<"u"?DOMException:void 0;function Vo(e){if(!(typeof e=="function"||typeof e=="object"))return!1;try{return new e,!0}catch{return!1}}function Ho(){let e=function(i,l){this.message=i||"",this.name=l||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}let Go=Vo(Ia)?Ia:Ho();function Da(e,t,i,l,f,p){let b=lt(e),R=ya(t);e._disturbed=!0;let I=!1,F=_(void 0);return E((U,W)=>{let J;if(p!==void 0){if(J=()=>{let k=new Go("Aborted","AbortError"),L=[];l||L.push(()=>t._state==="writable"?lr(t,k):_(void 0)),f||L.push(()=>e._state==="readable"?ge(e,k):_(void 0)),re(()=>Promise.all(L.map(V=>V())),!0,k)},p.aborted){J();return}p.addEventListener("abort",J)}function ye(){return E((k,L)=>{function V(ae){ae?k():g(pt(),V,L)}V(!1)})}function pt(){return I?_(!0):g(R._readyPromise,()=>E((k,L)=>{$t(b,{_chunkSteps:V=>{F=g(va(R,V),void 0,n),k(!1)},_closeSteps:()=>k(!0),_errorSteps:L})}))}if(Ce(e,b._closedPromise,k=>{l?ce(!0,k):re(()=>lr(t,k),!0,k)}),Ce(t,R._closedPromise,k=>{f?ce(!0,k):re(()=>ge(e,k),!0,k)}),X(e,b._closedPromise,()=>{i?ce():re(()=>xo(R))}),Re(t)||t._state==="closed"){let k=new TypeError("the destination writable stream closed before all data could be piped to it");f?ce(!0,k):re(()=>ge(e,k),!0,k)}M(ye());function je(){let k=F;return g(F,()=>k!==F?je():void 0)}function Ce(k,L,V){k._state==="errored"?V(k._storedError):P(L,V)}function X(k,L,V){k._state==="closed"?V():O(L,V)}function re(k,L,V){if(I)return;I=!0,t._state==="writable"&&!Re(t)?O(je(),ae):ae();function ae(){S(k(),()=>Oe(L,V),bt=>Oe(!0,bt))}}function ce(k,L){I||(I=!0,t._state==="writable"&&!Re(t)?O(je(),()=>Oe(k,L)):Oe(k,L))}function Oe(k,L){Ea(R),q(b),p!==void 0&&p.removeEventListener("abort",J),k?W(L):U(void 0)}})}class ht{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!pr(this))throw yr("desiredSize");return gn(this)}close(){if(!pr(this))throw yr("close");if(!mt(this))throw new TypeError("The stream is not in a state that permits close");Lt(this)}enqueue(t=void 0){if(!pr(this))throw yr("enqueue");if(!mt(this))throw new TypeError("The stream is not in a state that permits enqueue");return gr(this,t)}error(t=void 0){if(!pr(this))throw yr("error");We(this,t)}[Vr](t){Ue(this);let i=this._cancelAlgorithm(t);return br(this),i}[Hr](t){let i=this._controlledReadableStream;if(this._queue.length>0){let l=Kr(this);this._closeRequested&&this._queue.length===0?(br(this),Ft(i)):Mt(this),t._chunkSteps(l)}else Gn(i,t),Mt(this)}}Object.defineProperties(ht.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof r.toStringTag=="symbol"&&Object.defineProperty(ht.prototype,r.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function pr(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")?!1:e instanceof ht}function Mt(e){if(!Ma(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let i=e._pullAlgorithm();S(i,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Mt(e))},l=>{We(e,l)})}function Ma(e){let t=e._controlledReadableStream;return!mt(e)||!e._started?!1:!!(qe(t)&&Qt(t)>0||gn(e)>0)}function br(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Lt(e){if(!mt(e))return;let t=e._controlledReadableStream;e._closeRequested=!0,e._queue.length===0&&(br(e),Ft(t))}function gr(e,t){if(!mt(e))return;let i=e._controlledReadableStream;if(qe(i)&&Qt(i)>0)Qr(i,t,!1);else{let l;try{l=e._strategySizeAlgorithm(t)}catch(f){throw We(e,f),f}try{Zr(e,t,l)}catch(f){throw We(e,f),f}}Mt(e)}function We(e,t){let i=e._controlledReadableStream;i._state==="readable"&&(Ue(e),br(e),Ua(i,t))}function gn(e){let t=e._controlledReadableStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function Yo(e){return!Ma(e)}function mt(e){let t=e._controlledReadableStream._state;return!e._closeRequested&&t==="readable"}function La(e,t,i,l,f,p,b){t._controlledReadableStream=e,t._queue=void 0,t._queueTotalSize=void 0,Ue(t),t._started=!1,t._closeRequested=!1,t._pullAgain=!1,t._pulling=!1,t._strategySizeAlgorithm=b,t._strategyHWM=p,t._pullAlgorithm=l,t._cancelAlgorithm=f,e._readableStreamController=t;let R=i();S(_(R),()=>{t._started=!0,Mt(t)},I=>{We(t,I)})}function Jo(e,t,i,l){let f=Object.create(ht.prototype),p=()=>{},b=()=>_(void 0),R=()=>_(void 0);t.start!==void 0&&(p=()=>t.start(f)),t.pull!==void 0&&(b=()=>t.pull(f)),t.cancel!==void 0&&(R=I=>t.cancel(I)),La(e,f,p,b,R,i,l)}function yr(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function Qo(e,t){return Ge(e._readableStreamController)?Zo(e):Ko(e)}function Ko(e,t){let i=lt(e),l=!1,f=!1,p=!1,b=!1,R,I,F,U,W,J=E(X=>{W=X});function ye(){return l?(f=!0,_(void 0)):(l=!0,$t(i,{_chunkSteps:re=>{C(()=>{f=!1;let ce=re,Oe=re;p||gr(F._readableStreamController,ce),b||gr(U._readableStreamController,Oe),l=!1,f&&ye()})},_closeSteps:()=>{l=!1,p||Lt(F._readableStreamController),b||Lt(U._readableStreamController),(!p||!b)&&W(void 0)},_errorSteps:()=>{l=!1}}),_(void 0))}function pt(X){if(p=!0,R=X,b){let re=At([R,I]),ce=ge(e,re);W(ce)}return J}function je(X){if(b=!0,I=X,p){let re=At([R,I]),ce=ge(e,re);W(ce)}return J}function Ce(){}return F=yn(Ce,ye,pt),U=yn(Ce,ye,je),P(i._closedPromise,X=>{We(F._readableStreamController,X),We(U._readableStreamController,X),(!p||!b)&&W(void 0)}),[F,U]}function Zo(e){let t=lt(e),i=!1,l=!1,f=!1,p=!1,b=!1,R,I,F,U,W,J=E(k=>{W=k});function ye(k){P(k._closedPromise,L=>{k===t&&(be(F._readableStreamController,L),be(U._readableStreamController,L),(!p||!b)&&W(void 0))})}function pt(){Je(t)&&(q(t),t=lt(e),ye(t)),$t(t,{_chunkSteps:L=>{C(()=>{l=!1,f=!1;let V=L,ae=L;if(!p&&!b)try{ae=na(L)}catch(bt){be(F._readableStreamController,bt),be(U._readableStreamController,bt),W(ge(e,bt));return}p||rr(F._readableStreamController,V),b||rr(U._readableStreamController,ae),i=!1,l?Ce():f&&X()})},_closeSteps:()=>{i=!1,p||Pt(F._readableStreamController),b||Pt(U._readableStreamController),F._readableStreamController._pendingPullIntos.length>0&&nr(F._readableStreamController,0),U._readableStreamController._pendingPullIntos.length>0&&nr(U._readableStreamController,0),(!p||!b)&&W(void 0)},_errorSteps:()=>{i=!1}})}function je(k,L){Be(t)&&(q(t),t=ha(e),ye(t));let V=L?U:F,ae=L?F:U;ba(t,k,{_chunkSteps:gt=>{C(()=>{l=!1,f=!1;let yt=L?b:p;if(L?p:b)yt||ar(V._readableStreamController,gt);else{let Za;try{Za=na(gt)}catch(Sn){be(V._readableStreamController,Sn),be(ae._readableStreamController,Sn),W(ge(e,Sn));return}yt||ar(V._readableStreamController,gt),rr(ae._readableStreamController,Za)}i=!1,l?Ce():f&&X()})},_closeSteps:gt=>{i=!1;let yt=L?b:p,Tr=L?p:b;yt||Pt(V._readableStreamController),Tr||Pt(ae._readableStreamController),gt!==void 0&&(yt||ar(V._readableStreamController,gt),!Tr&&ae._readableStreamController._pendingPullIntos.length>0&&nr(ae._readableStreamController,0)),(!yt||!Tr)&&W(void 0)},_errorSteps:()=>{i=!1}})}function Ce(){if(i)return l=!0,_(void 0);i=!0;let k=rn(F._readableStreamController);return k===null?pt():je(k._view,!1),_(void 0)}function X(){if(i)return f=!0,_(void 0);i=!0;let k=rn(U._readableStreamController);return k===null?pt():je(k._view,!0),_(void 0)}function re(k){if(p=!0,R=k,b){let L=At([R,I]),V=ge(e,L);W(V)}return J}function ce(k){if(b=!0,I=k,p){let L=At([R,I]),V=ge(e,L);W(V)}return J}function Oe(){}return F=Ba(Oe,Ce,re),U=Ba(Oe,X,ce),ye(t),[F,U]}function Xo(e,t){Pe(e,t);let i=e,l=i?.autoAllocateChunkSize,f=i?.cancel,p=i?.pull,b=i?.start,R=i?.type;return{autoAllocateChunkSize:l===void 0?void 0:Hn(l,`${t} has member 'autoAllocateChunkSize' that`),cancel:f===void 0?void 0:es(f,i,`${t} has member 'cancel' that`),pull:p===void 0?void 0:ts(p,i,`${t} has member 'pull' that`),start:b===void 0?void 0:rs(b,i,`${t} has member 'start' that`),type:R===void 0?void 0:ns(R,`${t} has member 'type' that`)}}function es(e,t,i){return pe(e,i),l=>x(e,t,[l])}function ts(e,t,i){return pe(e,i),l=>x(e,t,[l])}function rs(e,t,i){return pe(e,i),l=>D(e,t,[l])}function ns(e,t){if(e=`${e}`,e!=="bytes")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function as(e,t){Pe(e,t);let i=e?.mode;return{mode:i===void 0?void 0:is(i,`${t} has member 'mode' that`)}}function is(e,t){if(e=`${e}`,e!=="byob")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function os(e,t){return Pe(e,t),{preventCancel:!!e?.preventCancel}}function Fa(e,t){Pe(e,t);let i=e?.preventAbort,l=e?.preventCancel,f=e?.preventClose,p=e?.signal;return p!==void 0&&ss(p,`${t} has member 'signal' that`),{preventAbort:!!i,preventCancel:!!l,preventClose:!!f,signal:p}}function ss(e,t){if(!wo(e))throw new TypeError(`${t} is not an AbortSignal.`)}function ls(e,t){Pe(e,t);let i=e?.readable;Gr(i,"readable","ReadableWritablePair"),Jr(i,`${t} has member 'readable' that`);let l=e?.writable;return Gr(l,"writable","ReadableWritablePair"),ga(l,`${t} has member 'writable' that`),{readable:i,writable:l}}class Ne{constructor(t={},i={}){t===void 0?t=null:jn(t,"First parameter");let l=sr(i,"Second parameter"),f=Xo(t,"First parameter");if(wn(this),f.type==="bytes"){if(l.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let p=Ot(l,0);co(this,f,p)}else{let p=or(l),b=Ot(l,1);Jo(this,f,b,p)}}get locked(){if(!ze(this))throw Ze("locked");return qe(this)}cancel(t=void 0){return ze(this)?qe(this)?y(new TypeError("Cannot cancel a stream that already has a reader")):ge(this,t):y(Ze("cancel"))}getReader(t=void 0){if(!ze(this))throw Ze("getReader");return as(t,"First parameter").mode===void 0?lt(this):ha(this)}pipeThrough(t,i={}){if(!ze(this))throw Ze("pipeThrough");ke(t,1,"pipeThrough");let l=ls(t,"First parameter"),f=Fa(i,"Second parameter");if(qe(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(ft(l.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let p=Da(this,l.writable,f.preventClose,f.preventAbort,f.preventCancel,f.signal);return M(p),l.readable}pipeTo(t,i={}){if(!ze(this))return y(Ze("pipeTo"));if(t===void 0)return y("Parameter 1 is required in 'pipeTo'.");if(!ut(t))return y(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let l;try{l=Fa(i,"Second parameter")}catch(f){return y(f)}return qe(this)?y(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):ft(t)?y(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):Da(this,t,l.preventClose,l.preventAbort,l.preventCancel,l.signal)}tee(){if(!ze(this))throw Ze("tee");let t=Qo(this);return At(t)}values(t=void 0){if(!ze(this))throw Ze("values");let i=os(t,"First parameter");return ro(this,i.preventCancel)}}Object.defineProperties(Ne.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),typeof r.toStringTag=="symbol"&&Object.defineProperty(Ne.prototype,r.toStringTag,{value:"ReadableStream",configurable:!0}),typeof r.asyncIterator=="symbol"&&Object.defineProperty(Ne.prototype,r.asyncIterator,{value:Ne.prototype.values,writable:!0,configurable:!0});function yn(e,t,i,l=1,f=()=>1){let p=Object.create(Ne.prototype);wn(p);let b=Object.create(ht.prototype);return La(p,b,e,t,i,l,f),p}function Ba(e,t,i){let l=Object.create(Ne.prototype);wn(l);let f=Object.create(ct.prototype);return da(l,f,e,t,i,0,void 0),l}function wn(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function ze(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")?!1:e instanceof Ne}function qe(e){return e._reader!==void 0}function ge(e,t){if(e._disturbed=!0,e._state==="closed")return _(void 0);if(e._state==="errored")return y(e._storedError);Ft(e);let i=e._reader;i!==void 0&&Je(i)&&(i._readIntoRequests.forEach(f=>{f._closeSteps(void 0)}),i._readIntoRequests=new Z);let l=e._readableStreamController[Vr](t);return T(l,n)}function Ft(e){e._state="closed";let t=e._reader;t!==void 0&&(Jt(t),Be(t)&&(t._readRequests.forEach(i=>{i._closeSteps()}),t._readRequests=new Z))}function Ua(e,t){e._state="errored",e._storedError=t;let i=e._reader;i!==void 0&&(me(i,t),Be(i)?(i._readRequests.forEach(l=>{l._errorSteps(t)}),i._readRequests=new Z):(i._readIntoRequests.forEach(l=>{l._errorSteps(t)}),i._readIntoRequests=new Z))}function Ze(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function Wa(e,t){Pe(e,t);let i=e?.highWaterMark;return Gr(i,"highWaterMark","QueuingStrategyInit"),{highWaterMark:Yr(i)}}let Na=e=>e.byteLength;try{Object.defineProperty(Na,"name",{value:"size",configurable:!0})}catch{}class wr{constructor(t){ke(t,1,"ByteLengthQueuingStrategy"),t=Wa(t,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!qa(this))throw za("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!qa(this))throw za("size");return Na}}Object.defineProperties(wr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof r.toStringTag=="symbol"&&Object.defineProperty(wr.prototype,r.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function za(e){return new TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function qa(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")?!1:e instanceof wr}let ja=()=>1;try{Object.defineProperty(ja,"name",{value:"size",configurable:!0})}catch{}class Sr{constructor(t){ke(t,1,"CountQueuingStrategy"),t=Wa(t,"First parameter"),this._countQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!Ha(this))throw Va("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!Ha(this))throw Va("size");return ja}}Object.defineProperties(Sr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof r.toStringTag=="symbol"&&Object.defineProperty(Sr.prototype,r.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function Va(e){return new TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function Ha(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")?!1:e instanceof Sr}function cs(e,t){Pe(e,t);let i=e?.flush,l=e?.readableType,f=e?.start,p=e?.transform,b=e?.writableType;return{flush:i===void 0?void 0:us(i,e,`${t} has member 'flush' that`),readableType:l,start:f===void 0?void 0:fs(f,e,`${t} has member 'start' that`),transform:p===void 0?void 0:ds(p,e,`${t} has member 'transform' that`),writableType:b}}function us(e,t,i){return pe(e,i),l=>x(e,t,[l])}function fs(e,t,i){return pe(e,i),l=>D(e,t,[l])}function ds(e,t,i){return pe(e,i),(l,f)=>x(e,t,[l,f])}class _r{constructor(t={},i={},l={}){t===void 0&&(t=null);let f=sr(i,"Second parameter"),p=sr(l,"Third parameter"),b=cs(t,"First parameter");if(b.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(b.writableType!==void 0)throw new RangeError("Invalid writableType specified");let R=Ot(p,0),I=or(p),F=Ot(f,1),U=or(f),W,J=E(ye=>{W=ye});hs(this,J,F,U,R,I),ps(this,b),b.start!==void 0?W(b.start(this._transformStreamController)):W(void 0)}get readable(){if(!Ga(this))throw Ka("readable");return this._readable}get writable(){if(!Ga(this))throw Ka("writable");return this._writable}}Object.defineProperties(_r.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof r.toStringTag=="symbol"&&Object.defineProperty(_r.prototype,r.toStringTag,{value:"TransformStream",configurable:!0});function hs(e,t,i,l,f,p){function b(){return t}function R(J){return ys(e,J)}function I(J){return ws(e,J)}function F(){return Ss(e)}e._writable=Ro(b,R,F,I,i,l);function U(){return _s(e)}function W(J){return Er(e,J),_(void 0)}e._readable=yn(b,U,W,f,p),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,vr(e,!0),e._transformStreamController=void 0}function Ga(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")?!1:e instanceof _r}function Rr(e,t){We(e._readable._readableStreamController,t),Er(e,t)}function Er(e,t){Ya(e._transformStreamController),fn(e._writable._writableStreamController,t),e._backpressure&&vr(e,!1)}function vr(e,t){e._backpressureChangePromise!==void 0&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=E(i=>{e._backpressureChangePromise_resolve=i}),e._backpressure=t}class Bt{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!$r(this))throw Ar("desiredSize");let t=this._controlledTransformStream._readable._readableStreamController;return gn(t)}enqueue(t=void 0){if(!$r(this))throw Ar("enqueue");Ja(this,t)}error(t=void 0){if(!$r(this))throw Ar("error");bs(this,t)}terminate(){if(!$r(this))throw Ar("terminate");gs(this)}}Object.defineProperties(Bt.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof r.toStringTag=="symbol"&&Object.defineProperty(Bt.prototype,r.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function $r(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")?!1:e instanceof Bt}function ms(e,t,i,l){t._controlledTransformStream=e,e._transformStreamController=t,t._transformAlgorithm=i,t._flushAlgorithm=l}function ps(e,t){let i=Object.create(Bt.prototype),l=p=>{try{return Ja(i,p),_(void 0)}catch(b){return y(b)}},f=()=>_(void 0);t.transform!==void 0&&(l=p=>t.transform(p,i)),t.flush!==void 0&&(f=()=>t.flush(i)),ms(e,i,l,f)}function Ya(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function Ja(e,t){let i=e._controlledTransformStream,l=i._readable._readableStreamController;if(!mt(l))throw new TypeError("Readable side is not in a state that permits enqueue");try{gr(l,t)}catch(p){throw Er(i,p),i._readable._storedError}Yo(l)!==i._backpressure&&vr(i,!0)}function bs(e,t){Rr(e._controlledTransformStream,t)}function Qa(e,t){let i=e._transformAlgorithm(t);return T(i,void 0,l=>{throw Rr(e._controlledTransformStream,l),l})}function gs(e){let t=e._controlledTransformStream,i=t._readable._readableStreamController;Lt(i);let l=new TypeError("TransformStream terminated");Er(t,l)}function ys(e,t){let i=e._transformStreamController;if(e._backpressure){let l=e._backpressureChangePromise;return T(l,()=>{let f=e._writable;if(f._state==="erroring")throw f._storedError;return Qa(i,t)})}return Qa(i,t)}function ws(e,t){return Rr(e,t),_(void 0)}function Ss(e){let t=e._readable,i=e._transformStreamController,l=i._flushAlgorithm();return Ya(i),T(l,()=>{if(t._state==="errored")throw t._storedError;Lt(t._readableStreamController)},f=>{throw Rr(e,f),t._storedError})}function _s(e){return vr(e,!1),e._backpressureChangePromise}function Ar(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function Ka(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}a.ByteLengthQueuingStrategy=wr,a.CountQueuingStrategy=Sr,a.ReadableByteStreamController=ct,a.ReadableStream=Ne,a.ReadableStreamBYOBReader=Ct,a.ReadableStreamBYOBRequest=Tt,a.ReadableStreamDefaultController=ht,a.ReadableStreamDefaultReader=vt,a.TransformStream=_r,a.TransformStreamDefaultController=Bt,a.WritableStream=xt,a.WritableStreamDefaultController=dt,a.WritableStreamDefaultWriter=It,Object.defineProperty(a,"__esModule",{value:!0})}))});var hi=_n(()=>{if(!globalThis.ReadableStream)try{let a=require("node:process"),{emitWarning:r}=a;try{a.emitWarning=()=>{},Object.assign(globalThis,require("node:stream/web")),a.emitWarning=r}catch(n){throw a.emitWarning=r,n}}catch{Object.assign(globalThis,di())}try{let{Blob:a}=require("buffer");a&&!a.prototype.stream&&(a.prototype.stream=function(n){let o=0,s=this;return new ReadableStream({type:"bytes",async pull(c){let d=await s.slice(o,Math.min(s.size,o+65536)).arrayBuffer();o+=d.byteLength,c.enqueue(new Uint8Array(d)),o===s.size&&c.close()}})})}catch{}});async function*An(a,r=!0){for(let n of a)if("stream"in n)yield*n.stream();else if(ArrayBuffer.isView(n))if(r){let o=n.byteOffset,s=n.byteOffset+n.byteLength;for(;o!==s;){let c=Math.min(s-o,mi),u=n.buffer.slice(o,o+c);o+=u.byteLength,yield new Uint8Array(u)}}else yield n;else{let o=0,s=n;for(;o!==s.size;){let u=await s.slice(o,Math.min(s.size,o+mi)).arrayBuffer();o+=u.byteLength,yield new Uint8Array(u)}}}var Sl,mi,pi,Ls,xe,zt=Ut(()=>{Sl=ie(hi(),1);mi=65536;pi=class Tn{#e=[];#t="";#r=0;#n="transparent";constructor(r=[],n={}){if(typeof r!="object"||r===null)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if(typeof r[Symbol.iterator]!="function")throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if(typeof n!="object"&&typeof n!="function")throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");n===null&&(n={});let o=new TextEncoder;for(let c of r){let u;ArrayBuffer.isView(c)?u=new Uint8Array(c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)):c instanceof ArrayBuffer?u=new Uint8Array(c.slice(0)):c instanceof Tn?u=c:u=o.encode(`${c}`),this.#r+=ArrayBuffer.isView(u)?u.byteLength:u.size,this.#e.push(u)}this.#n=`${n.endings===void 0?"transparent":n.endings}`;let s=n.type===void 0?"":String(n.type);this.#t=/^[\x20-\x7E]*$/.test(s)?s:""}get size(){return this.#r}get type(){return this.#t}async text(){let r=new TextDecoder,n="";for await(let o of An(this.#e,!1))n+=r.decode(o,{stream:!0});return n+=r.decode(),n}async arrayBuffer(){let r=new Uint8Array(this.size),n=0;for await(let o of An(this.#e,!1))r.set(o,n),n+=o.length;return r.buffer}stream(){let r=An(this.#e,!0);return new globalThis.ReadableStream({type:"bytes",async pull(n){let o=await r.next();o.done?n.close():n.enqueue(o.value)},async cancel(){await r.return()}})}slice(r=0,n=this.size,o=""){let{size:s}=this,c=r<0?Math.max(s+r,0):Math.min(r,s),u=n<0?Math.max(s+n,0):Math.min(n,s),d=Math.max(u-c,0),h=this.#e,m=[],A=0;for(let _ of h){if(A>=d)break;let y=ArrayBuffer.isView(_)?_.byteLength:_.size;if(c&&y<=c)c-=y,u-=y;else{let g;ArrayBuffer.isView(_)?(g=_.subarray(c,Math.min(y,u)),A+=g.byteLength):(g=_.slice(c,Math.min(y,u)),A+=g.size),u-=y,m.push(g),c=0}}let E=new Tn([],{type:String(o).toLowerCase()});return E.#r=d,E.#e=m,E}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](r){return r&&typeof r=="object"&&typeof r.constructor=="function"&&(typeof r.stream=="function"||typeof r.arrayBuffer=="function")&&/^(Blob|File)$/.test(r[Symbol.toStringTag])}};Object.defineProperties(pi.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});Ls=pi,xe=Ls});var Fs,Bs,St,Pn=Ut(()=>{zt();Fs=class extends xe{#e=0;#t="";constructor(r,n,o={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(r,o),o===null&&(o={});let s=o.lastModified===void 0?Date.now():Number(o.lastModified);Number.isNaN(s)||(this.#e=s),this.#t=String(n)}get name(){return this.#t}get lastModified(){return this.#e}get[Symbol.toStringTag](){return"File"}static[Symbol.hasInstance](r){return!!r&&r instanceof xe&&/^(File)$/.test(r[Symbol.toStringTag])}},Bs=Fs,St=Bs});function yi(a,r=xe){var n=`${bi()}${bi()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),o=[],s=`--${n}\r
Content-Disposition: form-data; name="`;return a.forEach((c,u)=>typeof c=="string"?o.push(s+kn(u)+`"\r
\r
${c.replace(/\r(?!\n)|(?<!\r)\n/g,`\r
`)}\r
`):o.push(s+kn(u)+`"; filename="${kn(c.name,1)}"\r
Content-Type: ${c.type||"application/octet-stream"}\r
\r
`,c,`\r
`)),o.push(`--${n}--`),new r(o,{type:"multipart/form-data; boundary="+n})}var qt,Us,Ws,bi,Ns,gi,kn,rt,nt,Mr=Ut(()=>{zt();Pn();({toStringTag:qt,iterator:Us,hasInstance:Ws}=Symbol),bi=Math.random,Ns="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),gi=(a,r,n)=>(a+="",/^(Blob|File)$/.test(r&&r[qt])?[(n=n!==void 0?n+"":r[qt]=="File"?r.name:"blob",a),r.name!==n||r[qt]=="blob"?new St([r],n,r):r]:[a,r+""]),kn=(a,r)=>(r?a:a.replace(/\r?\n|\r/g,`\r
`)).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),rt=(a,r,n)=>{if(r.length<n)throw new TypeError(`Failed to execute '${a}' on 'FormData': ${n} arguments required, but only ${r.length} present.`)},nt=class{#e=[];constructor(...r){if(r.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[qt](){return"FormData"}[Us](){return this.entries()}static[Ws](r){return r&&typeof r=="object"&&r[qt]==="FormData"&&!Ns.some(n=>typeof r[n]!="function")}append(...r){rt("append",arguments,2),this.#e.push(gi(...r))}delete(r){rt("delete",arguments,1),r+="",this.#e=this.#e.filter(([n])=>n!==r)}get(r){rt("get",arguments,1),r+="";for(var n=this.#e,o=n.length,s=0;s<o;s++)if(n[s][0]===r)return n[s][1];return null}getAll(r,n){return rt("getAll",arguments,1),n=[],r+="",this.#e.forEach(o=>o[0]===r&&n.push(o[1])),n}has(r){return rt("has",arguments,1),r+="",this.#e.some(n=>n[0]===r)}forEach(r,n){rt("forEach",arguments,1);for(var[o,s]of this)r.call(n,s,o,this)}set(...r){rt("set",arguments,2);var n=[],o=!0;r=gi(...r),this.#e.forEach(s=>{s[0]===r[0]?o&&(o=!n.push(r)):n.push(s)}),o&&n.push(r),this.#e=n}*entries(){yield*this.#e}*keys(){for(var[r]of this)yield r}*values(){for(var[,r]of this)yield r}}});var Ei=_n((Il,Ri)=>{if(!globalThis.DOMException)try{let{MessageChannel:a}=require("worker_threads"),r=new a().port1,n=new ArrayBuffer;r.postMessage(n,[n,n])}catch(a){a.constructor.name==="DOMException"&&(globalThis.DOMException=a.constructor)}Ri.exports=globalThis.DOMException});var Fr,zs,Ll,On=Ut(()=>{Fr=require("node:fs"),zs=ie(Ei(),1);Pn();zt();({stat:Ll}=Fr.promises)});var $i={};Xa($i,{toFormData:()=>Js});function Ys(a){let r=a.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!r)return;let n=r[2]||r[3]||"",o=n.slice(n.lastIndexOf("\\")+1);return o=o.replace(/%22/g,'"'),o=o.replace(/&#(\d{4});/g,(s,c)=>String.fromCharCode(c)),o}async function Js(a,r){if(!/multipart/i.test(r))throw new TypeError("Failed to fetch");let n=r.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!n)throw new TypeError("no or bad content-type header, no multipart boundary");let o=new xn(n[1]||n[2]),s,c,u,d,h,m,A=[],E=new nt,_=P=>{u+=O.decode(P,{stream:!0})},y=P=>{A.push(P)},g=()=>{let P=new St(A,m,{type:h});E.append(d,P)},S=()=>{E.append(d,u)},O=new TextDecoder("utf-8");O.decode(),o.onPartBegin=function(){o.onPartData=_,o.onPartEnd=S,s="",c="",u="",d="",h="",m=null,A.length=0},o.onHeaderField=function(P){s+=O.decode(P,{stream:!0})},o.onHeaderValue=function(P){c+=O.decode(P,{stream:!0})},o.onHeaderEnd=function(){if(c+=O.decode(),s=s.toLowerCase(),s==="content-disposition"){let P=c.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);P&&(d=P[2]||P[3]||""),m=Ys(c),m&&(o.onPartData=y,o.onPartEnd=g)}else s==="content-type"&&(h=c);c="",s=""};for await(let P of a)o.write(P);return o.end(),E}var $e,H,vi,Ve,Br,Ur,qs,Vt,js,Vs,Hs,Gs,at,xn,Ai=Ut(()=>{On();Mr();$e=0,H={START_BOUNDARY:$e++,HEADER_FIELD_START:$e++,HEADER_FIELD:$e++,HEADER_VALUE_START:$e++,HEADER_VALUE:$e++,HEADER_VALUE_ALMOST_DONE:$e++,HEADERS_ALMOST_DONE:$e++,PART_DATA_START:$e++,PART_DATA:$e++,END:$e++},vi=1,Ve={PART_BOUNDARY:vi,LAST_BOUNDARY:vi*=2},Br=10,Ur=13,qs=32,Vt=45,js=58,Vs=97,Hs=122,Gs=a=>a|32,at=()=>{},xn=class{constructor(r){this.index=0,this.flags=0,this.onHeaderEnd=at,this.onHeaderField=at,this.onHeadersEnd=at,this.onHeaderValue=at,this.onPartBegin=at,this.onPartData=at,this.onPartEnd=at,this.boundaryChars={},r=`\r
--`+r;let n=new Uint8Array(r.length);for(let o=0;o<r.length;o++)n[o]=r.charCodeAt(o),this.boundaryChars[n[o]]=!0;this.boundary=n,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=H.START_BOUNDARY}write(r){let n=0,o=r.length,s=this.index,{lookbehind:c,boundary:u,boundaryChars:d,index:h,state:m,flags:A}=this,E=this.boundary.length,_=E-1,y=r.length,g,S,O=C=>{this[C+"Mark"]=n},P=C=>{delete this[C+"Mark"]},T=(C,D,x,te)=>{(D===void 0||D!==x)&&this[C](te&&te.subarray(D,x))},M=(C,D)=>{let x=C+"Mark";x in this&&(D?(T(C,this[x],n,r),delete this[x]):(T(C,this[x],r.length,r),this[x]=0))};for(n=0;n<o;n++)switch(g=r[n],m){case H.START_BOUNDARY:if(h===u.length-2){if(g===Vt)A|=Ve.LAST_BOUNDARY;else if(g!==Ur)return;h++;break}else if(h-1===u.length-2){if(A&Ve.LAST_BOUNDARY&&g===Vt)m=H.END,A=0;else if(!(A&Ve.LAST_BOUNDARY)&&g===Br)h=0,T("onPartBegin"),m=H.HEADER_FIELD_START;else return;break}g!==u[h+2]&&(h=-2),g===u[h+2]&&h++;break;case H.HEADER_FIELD_START:m=H.HEADER_FIELD,O("onHeaderField"),h=0;case H.HEADER_FIELD:if(g===Ur){P("onHeaderField"),m=H.HEADERS_ALMOST_DONE;break}if(h++,g===Vt)break;if(g===js){if(h===1)return;M("onHeaderField",!0),m=H.HEADER_VALUE_START;break}if(S=Gs(g),S<Vs||S>Hs)return;break;case H.HEADER_VALUE_START:if(g===qs)break;O("onHeaderValue"),m=H.HEADER_VALUE;case H.HEADER_VALUE:g===Ur&&(M("onHeaderValue",!0),T("onHeaderEnd"),m=H.HEADER_VALUE_ALMOST_DONE);break;case H.HEADER_VALUE_ALMOST_DONE:if(g!==Br)return;m=H.HEADER_FIELD_START;break;case H.HEADERS_ALMOST_DONE:if(g!==Br)return;T("onHeadersEnd"),m=H.PART_DATA_START;break;case H.PART_DATA_START:m=H.PART_DATA,O("onPartData");case H.PART_DATA:if(s=h,h===0){for(n+=_;n<y&&!(r[n]in d);)n+=E;n-=_,g=r[n]}if(h<u.length)u[h]===g?(h===0&&M("onPartData",!0),h++):h=0;else if(h===u.length)h++,g===Ur?A|=Ve.PART_BOUNDARY:g===Vt?A|=Ve.LAST_BOUNDARY:h=0;else if(h-1===u.length)if(A&Ve.PART_BOUNDARY){if(h=0,g===Br){A&=~Ve.PART_BOUNDARY,T("onPartEnd"),T("onPartBegin"),m=H.HEADER_FIELD_START;break}}else A&Ve.LAST_BOUNDARY&&g===Vt?(T("onPartEnd"),m=H.END,A=0):h=0;if(h>0)c[h-1]=g;else if(s>0){let C=new Uint8Array(c.buffer,c.byteOffset,c.byteLength);T("onPartData",0,s,C),s=0,O("onPartData"),n--}break;case H.END:break;default:throw new Error(`Unexpected state entered: ${m}`)}M("onHeaderField"),M("onHeaderValue"),M("onPartData"),this.index=h,this.state=m,this.flags=A}end(){if(this.state===H.HEADER_FIELD_START&&this.index===0||this.state===H.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==H.END)throw new Error("MultipartParser.end(): stream ended unexpectedly")}}});var cl={};Xa(cl,{default:()=>Ki});module.exports=Ts(cl);var Se=ie(require("react")),w=require("@raycast/api");var B=ie(require("react")),N=require("@raycast/api");var ti=Object.prototype.hasOwnProperty;function kr(a,r){var n,o;if(a===r)return!0;if(a&&r&&(n=a.constructor)===r.constructor){if(n===Date)return a.getTime()===r.getTime();if(n===RegExp)return a.toString()===r.toString();if(n===Array){if((o=a.length)===r.length)for(;o--&&kr(a[o],r[o]););return o===-1}if(!n||typeof a=="object"){o=0;for(n in a)if(ti.call(a,n)&&++o&&!ti.call(r,n)||!(n in r)||!kr(a[n],r[n]))return!1;return Object.keys(r).length===o}}return a!==a&&r!==r}var Xe=ie(require("node:fs")),Cr=ie(require("node:path"));var ai=require("react/jsx-runtime");function Ps(a){let r=(0,B.useRef)(a),n=(0,B.useRef)(0);return kr(a,r.current)||(r.current=a,n.current+=1),(0,B.useMemo)(()=>r.current,[n.current])}function Ee(a){let r=(0,B.useRef)(a);return r.current=a,r}function En(a,r){let n=a instanceof Error?a.message:String(a);return(0,N.showToast)({style:N.Toast.Style.Failure,title:r?.title??"Something went wrong",message:r?.message??n,primaryAction:r?.primaryAction??ri(a),secondaryAction:r?.primaryAction?ri(a):void 0})}var ri=a=>{let r=!0,n="[Extension Name]...",o="";try{let u=JSON.parse((0,Xe.readFileSync)((0,Cr.join)(N.environment.assetsPath,"..","package.json"),"utf8"));n=`[${u.title}]...`,o=`https://raycast.com/${u.owner||u.author}/${u.name}`,(!u.owner||u.access==="public")&&(r=!1)}catch{}let s=N.environment.isDevelopment||r,c=a instanceof Error?a?.stack||a?.message||"":String(a);return{title:s?"Copy Logs":"Report Error",onAction(u){u.hide(),s?N.Clipboard.copy(c):(0,N.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(n)}&extension-url=${encodeURI(o)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${c}
\`\`\`
`)}`)}}};function Wt(a,r,n){let o=(0,B.useRef)(0),[s,c]=(0,B.useState)({isLoading:!0}),u=Ee(a),d=Ee(n?.abortable),h=Ee(r||[]),m=Ee(n?.onError),A=Ee(n?.onData),E=Ee(n?.onWillExecute),_=Ee(n?.failureToastOptions),y=Ee(s.data),g=(0,B.useRef)(null),S=(0,B.useRef)({page:0}),O=(0,B.useRef)(!1),P=(0,B.useRef)(!0),T=(0,B.useRef)(50),M=(0,B.useCallback)(()=>(d.current&&(d.current.current?.abort(),d.current.current=new AbortController),++o.current),[d]),C=(0,B.useCallback)((...q)=>{let j=M();E.current?.(q),c(z=>({...z,isLoading:!0}));let _e=ks(u.current)(...q);function Te(z){return z.name=="AbortError"||j===o.current&&(m.current?m.current(z):N.environment.launchType!==N.LaunchType.Background&&En(z,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(me){me.hide(),g.current?.(...h.current||[])}},..._.current}),c({error:z,isLoading:!1})),z}return typeof _e=="function"?(O.current=!0,_e(S.current).then(({data:z,hasMore:me,cursor:jr})=>(j===o.current&&(S.current&&(S.current.cursor=jr,S.current.lastItem=z?.[z.length-1]),A.current&&A.current(z,S.current),me&&(T.current=z.length),P.current=me,c(Jt=>S.current.page===0?{data:z,isLoading:!1}:{data:(Jt.data||[])?.concat(z),isLoading:!1})),z),z=>(P.current=!1,Te(z)))):(O.current=!1,_e.then(z=>(j===o.current&&(A.current&&A.current(z),c({data:z,isLoading:!1})),z),Te))},[A,m,h,u,c,g,E,S,_,M]);g.current=C;let D=(0,B.useCallback)(()=>{S.current={page:0};let q=h.current||[];return C(...q)},[C,h]),x=(0,B.useCallback)(async(q,j)=>{let _e;try{if(j?.optimisticUpdate){M(),typeof j?.rollbackOnError!="function"&&j?.rollbackOnError!==!1&&(_e=structuredClone(y.current?.value));let Te=j.optimisticUpdate;c(z=>({...z,data:Te(z.data)}))}return await q}catch(Te){if(typeof j?.rollbackOnError=="function"){let z=j.rollbackOnError;c(me=>({...me,data:z(me.data)}))}else j?.optimisticUpdate&&j?.rollbackOnError!==!1&&c(z=>({...z,data:_e}));throw Te}finally{j?.shouldRevalidateAfter!==!1&&(N.environment.launchType===N.LaunchType.Background||N.environment.commandMode==="menu-bar"?await D():D())}},[D,y,c,M]),te=(0,B.useCallback)(()=>{S.current.page+=1;let q=h.current||[];C(...q)},[S,h,C]);(0,B.useEffect)(()=>{S.current={page:0},n?.execute!==!1?C(...r||[]):M()},[Ps([r,n?.execute,C]),d,S]),(0,B.useEffect)(()=>()=>{M()},[M]);let Z=n?.execute!==!1?s.isLoading:!1,Fe={...s,isLoading:Z},v=O.current?{pageSize:T.current,hasMore:P.current,onLoadMore:te}:void 0;return{...Fe,revalidate:D,mutate:x,pagination:v}}function ks(a){return a===Promise.all||a===Promise.race||a===Promise.resolve||a===Promise.reject?a.bind(Promise):a}function Cs(a,r){let n=this[a];return n instanceof Date?`__raycast_cached_date__${n.toISOString()}`:Buffer.isBuffer(n)?`__raycast_cached_buffer__${n.toString("base64")}`:r}function Os(a,r){return typeof r=="string"&&r.startsWith("__raycast_cached_date__")?new Date(r.replace("__raycast_cached_date__","")):typeof r=="string"&&r.startsWith("__raycast_cached_buffer__")?Buffer.from(r.replace("__raycast_cached_buffer__",""),"base64"):r}var Nt=(function(a){return a.Required="required",a})({});function Rn(a,r){if(a){if(typeof a=="function")return a(r);if(a==="required"){let n=typeof r<"u"&&r!==null;if(n)switch(typeof r){case"string":n=r.length>0;break;case"object":Array.isArray(r)?n=r.length>0:r instanceof Date&&(n=r.getTime()>0);break;default:break}if(!n)return"The item is required"}}}function Or(a){let{onSubmit:r,validation:n,initialValues:o={}}=a,[s,c]=(0,B.useState)(o),[u,d]=(0,B.useState)({}),h=(0,B.useRef)({}),m=Ee(n||{}),A=Ee(r),E=(0,B.useCallback)(P=>{h.current[P]?.focus()},[h]),_=(0,B.useCallback)(async P=>{let T=!1;for(let[C,D]of Object.entries(m.current)){let x=Rn(D,P[C]);x&&(T||(T={},E(C)),T[C]=x)}if(T)return d(T),!1;let M=await A.current(P);return typeof M=="boolean"?M:!0},[m,A,E]),y=(0,B.useCallback)((P,T)=>{d(M=>({...M,[P]:T}))},[d]),g=(0,B.useCallback)(function(P,T){c(M=>({...M,[P]:typeof T=="function"?T(M[P]):T}))},[c]),S=(0,B.useMemo)(()=>new Proxy({},{get(P,T){let M=m.current[T],C=s[T];return{onChange(D){u[T]&&(Rn(M,D)||y(T,void 0)),g(T,D)},onBlur(D){let x=Rn(M,D.target.value);x&&y(T,x)},error:u[T],id:T,value:typeof C>"u"?null:C,ref:D=>{h.current[T]=D}}}}),[u,m,y,s,h,g]),O=(0,B.useCallback)(P=>{d({}),Object.entries(h.current).forEach(([T,M])=>{P?.[T]||M?.reset()}),P&&c(P)},[c,d,h]);return{handleSubmit:_,setValidationError:y,setValue:g,values:s,itemProps:S,focus:E,reset:O}}function ii(a,r){let{data:n,isLoading:o,mutate:s}=Wt(async d=>{let h=await N.LocalStorage.getItem(d);return typeof h<"u"?JSON.parse(h,Os):r},[a]);async function c(d){try{await s(N.LocalStorage.setItem(a,JSON.stringify(d,Cs)),{optimisticUpdate(h){return h}})}catch(h){await En(h,{title:"Failed to set value in local storage"})}}async function u(){try{await s(N.LocalStorage.removeItem(a),{optimisticUpdate(){}})}catch(d){await En(d,{title:"Failed to remove value from local storage"})}}return{value:n,setValue:c,removeValue:u,isLoading:o}}function ni(a,r,n,o){let s=(o-90)*Math.PI/180;return{x:a+n*Math.cos(s),y:r+n*Math.sin(s)}}function xs(a,r,n,o,s){let c=ni(a,r,n,s),u=ni(a,r,n,o),d=s-o<=180?"0":"1";return["M",c.x,c.y,"A",n,n,0,d,0,u.x,u.y].join(" ")}function oi(a,r=N.Color.Red,n){let o=n?.background||(N.environment.appearance==="light"?"black":"white"),s=n?.backgroundOpacity||.1,c=10,d=50-5-c/2,h=`<svg xmlns="http://www.w3.org/2000/svg" width="100px" height="100px">
      <circle cx="50" cy="50" r="${d}" stroke-width="${c}" stroke="${a<1?o:r}" opacity="${a<1?s:"1"}" fill="none" />
      ${a>0&&a<1?`<path d="${xs(50,50,d,0,a*360)}" stroke="${r}" stroke-width="${c}" fill="none" />`:""}
    </svg>
  `.replaceAll(`
`,"");return`data:image/svg+xml,${encodeURIComponent(h)}`}var wt=require("@raycast/api");async function et(){let a=new Map;a.set("Local",{url:"http://127.0.0.1:11434"});let r=await wt.LocalStorage.getItem("settings_ollama_servers");return r&&(a=new Map([...a,...JSON.parse(r)])),a}async function vn(){let a=new Map,r=await wt.LocalStorage.getItem("settings_ollama_servers");return r&&(a=new Map([...JSON.parse(r)])),a}async function $n(a,r){let n=await vn();if([...n.keys()].findIndex(o=>o===a)===-1){n.set(a,r),await wt.LocalStorage.setItem("settings_ollama_servers",JSON.stringify([...n.entries()]));return}throw new Error("Name Already used")}async function si(a,r){let n=await vn();n.set(a,r),await wt.LocalStorage.setItem("settings_ollama_servers",JSON.stringify([...n.entries()]))}async function xr(a){let r=await vn();r.delete(a),await wt.LocalStorage.setItem("settings_ollama_servers",JSON.stringify([...r.entries()]))}var li=new Error("Model is not Installed."),ci=new Error("Ollama version not supported, update at least at v0.1.14."),ve=new Error("Verify Ollama is Installed and Currently Running."),bl=new Error("Ollama Models Registry is Unreachable."),Ir=class extends Error{constructor(r,n){super(r),this.model=n,this.suggest="Select a different model or install throw 'Manage Models' command"}},tt=class extends Error{constructor(r,n,o,s){super(r),this.route=n,this.code=o,this.req=s}};var Ni=ie(require("node:http"),1),zi=ie(require("node:https"),1),ot=ie(require("node:zlib"),1),le=ie(require("node:stream"),1),Yt=require("node:buffer");function Ms(a){if(!/^data:/i.test(a))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');a=a.replace(/\r?\n/g,"");let r=a.indexOf(",");if(r===-1||r<=4)throw new TypeError("malformed data: URI");let n=a.substring(5,r).split(";"),o="",s=!1,c=n[0]||"text/plain",u=c;for(let A=1;A<n.length;A++)n[A]==="base64"?s=!0:n[A]&&(u+=`;${n[A]}`,n[A].indexOf("charset=")===0&&(o=n[A].substring(8)));!n[0]&&!o.length&&(u+=";charset=US-ASCII",o="US-ASCII");let d=s?"base64":"ascii",h=unescape(a.substring(r+1)),m=Buffer.from(h,d);return m.type=c,m.typeFull=u,m.charset=o,m}var ui=Ms;var ue=ie(require("node:stream"),1),De=require("node:util"),oe=require("node:buffer");zt();Mr();var Ie=class extends Error{constructor(r,n){super(r),Error.captureStackTrace(this,this.constructor),this.type=n}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var G=class extends Ie{constructor(r,n,o){super(r,n),o&&(this.code=this.errno=o.code,this.erroredSysCall=o.syscall)}};var Lr=Symbol.toStringTag,Cn=a=>typeof a=="object"&&typeof a.append=="function"&&typeof a.delete=="function"&&typeof a.get=="function"&&typeof a.getAll=="function"&&typeof a.has=="function"&&typeof a.set=="function"&&typeof a.sort=="function"&&a[Lr]==="URLSearchParams",jt=a=>a&&typeof a=="object"&&typeof a.arrayBuffer=="function"&&typeof a.type=="string"&&typeof a.stream=="function"&&typeof a.constructor=="function"&&/^(Blob|File)$/.test(a[Lr]),wi=a=>typeof a=="object"&&(a[Lr]==="AbortSignal"||a[Lr]==="EventTarget"),Si=(a,r)=>{let n=new URL(r).hostname,o=new URL(a).hostname;return n===o||n.endsWith(`.${o}`)},_i=(a,r)=>{let n=new URL(r).protocol,o=new URL(a).protocol;return n===o};var Qs=(0,De.promisify)(ue.default.pipeline),ne=Symbol("Body internals"),Ae=class{constructor(r,{size:n=0}={}){let o=null;r===null?r=null:Cn(r)?r=oe.Buffer.from(r.toString()):jt(r)||oe.Buffer.isBuffer(r)||(De.types.isAnyArrayBuffer(r)?r=oe.Buffer.from(r):ArrayBuffer.isView(r)?r=oe.Buffer.from(r.buffer,r.byteOffset,r.byteLength):r instanceof ue.default||(r instanceof nt?(r=yi(r),o=r.type.split("=")[1]):r=oe.Buffer.from(String(r))));let s=r;oe.Buffer.isBuffer(r)?s=ue.default.Readable.from(r):jt(r)&&(s=ue.default.Readable.from(r.stream())),this[ne]={body:r,stream:s,boundary:o,disturbed:!1,error:null},this.size=n,r instanceof ue.default&&r.on("error",c=>{let u=c instanceof Ie?c:new G(`Invalid response body while trying to fetch ${this.url}: ${c.message}`,"system",c);this[ne].error=u})}get body(){return this[ne].stream}get bodyUsed(){return this[ne].disturbed}async arrayBuffer(){let{buffer:r,byteOffset:n,byteLength:o}=await In(this);return r.slice(n,n+o)}async formData(){let r=this.headers.get("content-type");if(r.startsWith("application/x-www-form-urlencoded")){let o=new nt,s=new URLSearchParams(await this.text());for(let[c,u]of s)o.append(c,u);return o}let{toFormData:n}=await Promise.resolve().then(()=>(Ai(),$i));return n(this.body,r)}async blob(){let r=this.headers&&this.headers.get("content-type")||this[ne].body&&this[ne].body.type||"",n=await this.arrayBuffer();return new xe([n],{type:r})}async json(){let r=await this.text();return JSON.parse(r)}async text(){let r=await In(this);return new TextDecoder().decode(r)}buffer(){return In(this)}};Ae.prototype.buffer=(0,De.deprecate)(Ae.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer");Object.defineProperties(Ae.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0},data:{get:(0,De.deprecate)(()=>{},"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});async function In(a){if(a[ne].disturbed)throw new TypeError(`body used already for: ${a.url}`);if(a[ne].disturbed=!0,a[ne].error)throw a[ne].error;let{body:r}=a;if(r===null)return oe.Buffer.alloc(0);if(!(r instanceof ue.default))return oe.Buffer.alloc(0);let n=[],o=0;try{for await(let s of r){if(a.size>0&&o+s.length>a.size){let c=new G(`content size at ${a.url} over limit: ${a.size}`,"max-size");throw r.destroy(c),c}o+=s.length,n.push(s)}}catch(s){throw s instanceof Ie?s:new G(`Invalid response body while trying to fetch ${a.url}: ${s.message}`,"system",s)}if(r.readableEnded===!0||r._readableState.ended===!0)try{return n.every(s=>typeof s=="string")?oe.Buffer.from(n.join("")):oe.Buffer.concat(n,o)}catch(s){throw new G(`Could not create Buffer from response body for ${a.url}: ${s.message}`,"system",s)}else throw new G(`Premature close of server response while trying to fetch ${a.url}`)}var _t=(a,r)=>{let n,o,{body:s}=a[ne];if(a.bodyUsed)throw new Error("cannot clone body after it is used");return s instanceof ue.default&&typeof s.getBoundary!="function"&&(n=new ue.PassThrough({highWaterMark:r}),o=new ue.PassThrough({highWaterMark:r}),s.pipe(n),s.pipe(o),a[ne].stream=n,s=o),s},Ks=(0,De.deprecate)(a=>a.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),Wr=(a,r)=>a===null?null:typeof a=="string"?"text/plain;charset=UTF-8":Cn(a)?"application/x-www-form-urlencoded;charset=UTF-8":jt(a)?a.type||null:oe.Buffer.isBuffer(a)||De.types.isAnyArrayBuffer(a)||ArrayBuffer.isView(a)?null:a instanceof nt?`multipart/form-data; boundary=${r[ne].boundary}`:a&&typeof a.getBoundary=="function"?`multipart/form-data;boundary=${Ks(a)}`:a instanceof ue.default?null:"text/plain;charset=UTF-8",Ti=a=>{let{body:r}=a[ne];return r===null?0:jt(r)?r.size:oe.Buffer.isBuffer(r)?r.length:r&&typeof r.getLengthSync=="function"&&r.hasKnownLength&&r.hasKnownLength()?r.getLengthSync():null},Pi=async(a,{body:r})=>{r===null?a.end():await Qs(r,a)};var Dn=require("node:util"),Ht=ie(require("node:http"),1),Nr=typeof Ht.default.validateHeaderName=="function"?Ht.default.validateHeaderName:a=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(a)){let r=new TypeError(`Header name must be a valid HTTP token [${a}]`);throw Object.defineProperty(r,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),r}},Mn=typeof Ht.default.validateHeaderValue=="function"?Ht.default.validateHeaderValue:(a,r)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(r)){let n=new TypeError(`Invalid character in header content ["${a}"]`);throw Object.defineProperty(n,"code",{value:"ERR_INVALID_CHAR"}),n}},se=class a extends URLSearchParams{constructor(r){let n=[];if(r instanceof a){let o=r.raw();for(let[s,c]of Object.entries(o))n.push(...c.map(u=>[s,u]))}else if(r!=null)if(typeof r=="object"&&!Dn.types.isBoxedPrimitive(r)){let o=r[Symbol.iterator];if(o==null)n.push(...Object.entries(r));else{if(typeof o!="function")throw new TypeError("Header pairs must be iterable");n=[...r].map(s=>{if(typeof s!="object"||Dn.types.isBoxedPrimitive(s))throw new TypeError("Each header pair must be an iterable object");return[...s]}).map(s=>{if(s.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...s]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return n=n.length>0?n.map(([o,s])=>(Nr(o),Mn(o,String(s)),[String(o).toLowerCase(),String(s)])):void 0,super(n),new Proxy(this,{get(o,s,c){switch(s){case"append":case"set":return(u,d)=>(Nr(u),Mn(u,String(d)),URLSearchParams.prototype[s].call(o,String(u).toLowerCase(),String(d)));case"delete":case"has":case"getAll":return u=>(Nr(u),URLSearchParams.prototype[s].call(o,String(u).toLowerCase()));case"keys":return()=>(o.sort(),new Set(URLSearchParams.prototype.keys.call(o)).keys());default:return Reflect.get(o,s,c)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(r){let n=this.getAll(r);if(n.length===0)return null;let o=n.join(", ");return/^content-encoding$/i.test(r)&&(o=o.toLowerCase()),o}forEach(r,n=void 0){for(let o of this.keys())Reflect.apply(r,n,[this.get(o),o,this])}*values(){for(let r of this.keys())yield this.get(r)}*entries(){for(let r of this.keys())yield[r,this.get(r)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((r,n)=>(r[n]=this.getAll(n),r),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((r,n)=>{let o=this.getAll(n);return n==="host"?r[n]=o[0]:r[n]=o.length>1?o:o[0],r},{})}};Object.defineProperties(se.prototype,["get","entries","forEach","values"].reduce((a,r)=>(a[r]={enumerable:!0},a),{}));function ki(a=[]){return new se(a.reduce((r,n,o,s)=>(o%2===0&&r.push(s.slice(o,o+2)),r),[]).filter(([r,n])=>{try{return Nr(r),Mn(r,String(n)),!0}catch{return!1}}))}var Zs=new Set([301,302,303,307,308]),zr=a=>Zs.has(a);var we=Symbol("Response internals"),fe=class a extends Ae{constructor(r=null,n={}){super(r,n);let o=n.status!=null?n.status:200,s=new se(n.headers);if(r!==null&&!s.has("Content-Type")){let c=Wr(r,this);c&&s.append("Content-Type",c)}this[we]={type:"default",url:n.url,status:o,statusText:n.statusText||"",headers:s,counter:n.counter,highWaterMark:n.highWaterMark}}get type(){return this[we].type}get url(){return this[we].url||""}get status(){return this[we].status}get ok(){return this[we].status>=200&&this[we].status<300}get redirected(){return this[we].counter>0}get statusText(){return this[we].statusText}get headers(){return this[we].headers}get highWaterMark(){return this[we].highWaterMark}clone(){return new a(_t(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(r,n=302){if(!zr(n))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new a(null,{headers:{location:new URL(r).toString()},status:n})}static error(){let r=new a(null,{status:0,statusText:""});return r[we].type="error",r}static json(r=void 0,n={}){let o=JSON.stringify(r);if(o===void 0)throw new TypeError("data is not JSON serializable");let s=new se(n&&n.headers);return s.has("content-type")||s.set("content-type","application/json"),new a(o,{...n,headers:s})}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(fe.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var Bi=require("node:url"),Ui=require("node:util");var Ci=a=>{if(a.search)return a.search;let r=a.href.length-1,n=a.hash||(a.href[r]==="#"?"#":"");return a.href[r-n.length]==="?"?"?":""};var xi=require("node:net");function Oi(a,r=!1){return a==null||(a=new URL(a),/^(about|blob|data):$/.test(a.protocol))?"no-referrer":(a.username="",a.password="",a.hash="",r&&(a.pathname="",a.search=""),a)}var Ii=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]),Di="strict-origin-when-cross-origin";function Mi(a){if(!Ii.has(a))throw new TypeError(`Invalid referrerPolicy: ${a}`);return a}function Xs(a){if(/^(http|ws)s:$/.test(a.protocol))return!0;let r=a.host.replace(/(^\[)|(]$)/g,""),n=(0,xi.isIP)(r);return n===4&&/^127\./.test(r)||n===6&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(r)?!0:a.host==="localhost"||a.host.endsWith(".localhost")?!1:a.protocol==="file:"}function Rt(a){return/^about:(blank|srcdoc)$/.test(a)||a.protocol==="data:"||/^(blob|filesystem):$/.test(a.protocol)?!0:Xs(a)}function Li(a,{referrerURLCallback:r,referrerOriginCallback:n}={}){if(a.referrer==="no-referrer"||a.referrerPolicy==="")return null;let o=a.referrerPolicy;if(a.referrer==="about:client")return"no-referrer";let s=a.referrer,c=Oi(s),u=Oi(s,!0);c.toString().length>4096&&(c=u),r&&(c=r(c)),n&&(u=n(u));let d=new URL(a.url);switch(o){case"no-referrer":return"no-referrer";case"origin":return u;case"unsafe-url":return c;case"strict-origin":return Rt(c)&&!Rt(d)?"no-referrer":u.toString();case"strict-origin-when-cross-origin":return c.origin===d.origin?c:Rt(c)&&!Rt(d)?"no-referrer":u;case"same-origin":return c.origin===d.origin?c:"no-referrer";case"origin-when-cross-origin":return c.origin===d.origin?c:u;case"no-referrer-when-downgrade":return Rt(c)&&!Rt(d)?"no-referrer":c;default:throw new TypeError(`Invalid referrerPolicy: ${o}`)}}function Fi(a){let r=(a.get("referrer-policy")||"").split(/[,\s]+/),n="";for(let o of r)o&&Ii.has(o)&&(n=o);return n}var Q=Symbol("Request internals"),Gt=a=>typeof a=="object"&&typeof a[Q]=="object",el=(0,Ui.deprecate)(()=>{},".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)"),it=class a extends Ae{constructor(r,n={}){let o;if(Gt(r)?o=new URL(r.url):(o=new URL(r),r={}),o.username!==""||o.password!=="")throw new TypeError(`${o} is an url with embedded credentials.`);let s=n.method||r.method||"GET";if(/^(delete|get|head|options|post|put)$/i.test(s)&&(s=s.toUpperCase()),!Gt(n)&&"data"in n&&el(),(n.body!=null||Gt(r)&&r.body!==null)&&(s==="GET"||s==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let c=n.body?n.body:Gt(r)&&r.body!==null?_t(r):null;super(c,{size:n.size||r.size||0});let u=new se(n.headers||r.headers||{});if(c!==null&&!u.has("Content-Type")){let m=Wr(c,this);m&&u.set("Content-Type",m)}let d=Gt(r)?r.signal:null;if("signal"in n&&(d=n.signal),d!=null&&!wi(d))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let h=n.referrer==null?r.referrer:n.referrer;if(h==="")h="no-referrer";else if(h){let m=new URL(h);h=/^about:(\/\/)?client$/.test(m)?"client":m}else h=void 0;this[Q]={method:s,redirect:n.redirect||r.redirect||"follow",headers:u,parsedURL:o,signal:d,referrer:h},this.follow=n.follow===void 0?r.follow===void 0?20:r.follow:n.follow,this.compress=n.compress===void 0?r.compress===void 0?!0:r.compress:n.compress,this.counter=n.counter||r.counter||0,this.agent=n.agent||r.agent,this.highWaterMark=n.highWaterMark||r.highWaterMark||16384,this.insecureHTTPParser=n.insecureHTTPParser||r.insecureHTTPParser||!1,this.referrerPolicy=n.referrerPolicy||r.referrerPolicy||""}get method(){return this[Q].method}get url(){return(0,Bi.format)(this[Q].parsedURL)}get headers(){return this[Q].headers}get redirect(){return this[Q].redirect}get signal(){return this[Q].signal}get referrer(){if(this[Q].referrer==="no-referrer")return"";if(this[Q].referrer==="client")return"about:client";if(this[Q].referrer)return this[Q].referrer.toString()}get referrerPolicy(){return this[Q].referrerPolicy}set referrerPolicy(r){this[Q].referrerPolicy=Mi(r)}clone(){return new a(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(it.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});var Wi=a=>{let{parsedURL:r}=a[Q],n=new se(a[Q].headers);n.has("Accept")||n.set("Accept","*/*");let o=null;if(a.body===null&&/^(post|put)$/i.test(a.method)&&(o="0"),a.body!==null){let d=Ti(a);typeof d=="number"&&!Number.isNaN(d)&&(o=String(d))}o&&n.set("Content-Length",o),a.referrerPolicy===""&&(a.referrerPolicy=Di),a.referrer&&a.referrer!=="no-referrer"?a[Q].referrer=Li(a):a[Q].referrer="no-referrer",a[Q].referrer instanceof URL&&n.set("Referer",a.referrer),n.has("User-Agent")||n.set("User-Agent","node-fetch"),a.compress&&!n.has("Accept-Encoding")&&n.set("Accept-Encoding","gzip, deflate, br");let{agent:s}=a;typeof s=="function"&&(s=s(r));let c=Ci(r),u={path:r.pathname+c,method:a.method,headers:n[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:a.insecureHTTPParser,agent:s};return{parsedURL:r,options:u}};var qr=class extends Ie{constructor(r,n="aborted"){super(r,n)}};Mr();On();var tl=new Set(["data:","http:","https:"]);async function de(a,r){return new Promise((n,o)=>{let s=new it(a,r),{parsedURL:c,options:u}=Wi(s);if(!tl.has(c.protocol))throw new TypeError(`node-fetch cannot load ${a}. URL scheme "${c.protocol.replace(/:$/,"")}" is not supported.`);if(c.protocol==="data:"){let g=ui(s.url),S=new fe(g,{headers:{"Content-Type":g.typeFull}});n(S);return}let d=(c.protocol==="https:"?zi.default:Ni.default).request,{signal:h}=s,m=null,A=()=>{let g=new qr("The operation was aborted.");o(g),s.body&&s.body instanceof le.default.Readable&&s.body.destroy(g),!(!m||!m.body)&&m.body.emit("error",g)};if(h&&h.aborted){A();return}let E=()=>{A(),y()},_=d(c.toString(),u);h&&h.addEventListener("abort",E);let y=()=>{_.abort(),h&&h.removeEventListener("abort",E)};_.on("error",g=>{o(new G(`request to ${s.url} failed, reason: ${g.message}`,"system",g)),y()}),rl(_,g=>{m&&m.body&&m.body.destroy(g)}),process.version<"v14"&&_.on("socket",g=>{let S;g.prependListener("end",()=>{S=g._eventsCount}),g.prependListener("close",O=>{if(m&&S<g._eventsCount&&!O){let P=new Error("Premature close");P.code="ERR_STREAM_PREMATURE_CLOSE",m.body.emit("error",P)}})}),_.on("response",g=>{_.setTimeout(0);let S=ki(g.rawHeaders);if(zr(g.statusCode)){let C=S.get("Location"),D=null;try{D=C===null?null:new URL(C,s.url)}catch{if(s.redirect!=="manual"){o(new G(`uri requested responds with an invalid redirect URL: ${C}`,"invalid-redirect")),y();return}}switch(s.redirect){case"error":o(new G(`uri requested responds with a redirect, redirect mode is set to error: ${s.url}`,"no-redirect")),y();return;case"manual":break;case"follow":{if(D===null)break;if(s.counter>=s.follow){o(new G(`maximum redirect reached at: ${s.url}`,"max-redirect")),y();return}let x={headers:new se(s.headers),follow:s.follow,counter:s.counter+1,agent:s.agent,compress:s.compress,method:s.method,body:_t(s),signal:s.signal,size:s.size,referrer:s.referrer,referrerPolicy:s.referrerPolicy};if(!Si(s.url,D)||!_i(s.url,D))for(let Z of["authorization","www-authenticate","cookie","cookie2"])x.headers.delete(Z);if(g.statusCode!==303&&s.body&&r.body instanceof le.default.Readable){o(new G("Cannot follow redirect with body being a readable stream","unsupported-redirect")),y();return}(g.statusCode===303||(g.statusCode===301||g.statusCode===302)&&s.method==="POST")&&(x.method="GET",x.body=void 0,x.headers.delete("content-length"));let te=Fi(S);te&&(x.referrerPolicy=te),n(de(new it(D,x))),y();return}default:return o(new TypeError(`Redirect option '${s.redirect}' is not a valid value of RequestRedirect`))}}h&&g.once("end",()=>{h.removeEventListener("abort",E)});let O=(0,le.pipeline)(g,new le.PassThrough,C=>{C&&o(C)});process.version<"v12.10"&&g.on("aborted",E);let P={url:s.url,status:g.statusCode,statusText:g.statusMessage,headers:S,size:s.size,counter:s.counter,highWaterMark:s.highWaterMark},T=S.get("Content-Encoding");if(!s.compress||s.method==="HEAD"||T===null||g.statusCode===204||g.statusCode===304){m=new fe(O,P),n(m);return}let M={flush:ot.default.Z_SYNC_FLUSH,finishFlush:ot.default.Z_SYNC_FLUSH};if(T==="gzip"||T==="x-gzip"){O=(0,le.pipeline)(O,ot.default.createGunzip(M),C=>{C&&o(C)}),m=new fe(O,P),n(m);return}if(T==="deflate"||T==="x-deflate"){let C=(0,le.pipeline)(g,new le.PassThrough,D=>{D&&o(D)});C.once("data",D=>{(D[0]&15)===8?O=(0,le.pipeline)(O,ot.default.createInflate(),x=>{x&&o(x)}):O=(0,le.pipeline)(O,ot.default.createInflateRaw(),x=>{x&&o(x)}),m=new fe(O,P),n(m)}),C.once("end",()=>{m||(m=new fe(O,P),n(m))});return}if(T==="br"){O=(0,le.pipeline)(O,ot.default.createBrotliDecompress(),C=>{C&&o(C)}),m=new fe(O,P),n(m);return}m=new fe(O,P),n(m)}),Pi(_,s).catch(o)})}function rl(a,r){let n=Yt.Buffer.from(`0\r
\r
`),o=!1,s=!1,c;a.on("response",u=>{let{headers:d}=u;o=d["transfer-encoding"]==="chunked"&&!d["content-length"]}),a.on("socket",u=>{let d=()=>{if(o&&!s){let m=new Error("Premature close");m.code="ERR_STREAM_PREMATURE_CLOSE",r(m)}},h=m=>{s=Yt.Buffer.compare(m.slice(-5),n)===0,!s&&c&&(s=Yt.Buffer.compare(c.slice(-3),n.slice(0,3))===0&&Yt.Buffer.compare(m.slice(-2),n.slice(3))===0),c=m};u.prependListener("close",d),u.on("data",h),a.on("close",()=>{u.removeListener("close",d),u.removeListener("data",h)})})}var Ln=require("stream");var Et=class{constructor(r={url:"http://127.0.0.1:11434"}){this._RouteApiVersion="/api/version";this._RouteApiTags="/api/tags";this._RouteApiShow="/api/show";this._RouteApiDelete="/api/delete";this._RouteApiPull="/api/pull";this._RouteApiGenerate="/api/generate";this._RouteApiChat="/api/chat";this._RouteApiEmbeddings="/api/embeddings";this._RouteApiPs="/api/ps";this._signal=AbortSignal.timeout(1800),this._server=r.url,r.auth&&r.auth.mode==="Basic"&&(this._headers={Authorization:`${r.auth.mode} ${btoa(`${r.auth.username}:${r.auth.password}`)}`}),r.auth&&r.auth.mode==="Bearer"&&(this._headers={Authorization:`${r.auth.mode} ${r.auth.token}`})}set server(r){this._server=r.url,r.auth&&r.auth.mode==="Basic"&&(this._headers={Authorization:`${r.auth.mode} ${btoa(`${r.auth.username}:${r.auth.password}`)}`}),r.auth&&r.auth.mode==="Bearer"&&(this._headers={Authorization:`${r.auth.mode} ${r.auth.token}`})}_ErrorLogger(r){r instanceof tt?console.error(`Error: Route '${r.route}', Code '${r.code}', Message: ${r.message}${r.req&&` Req: ${r.req}`}`):console.error(`Error: ${r.message}`),r.stack&&console.error(`Stack trace: ${r.stack}`)}_ErrorHandlerOllamaServer(r,n,o,s,c){throw r in[this._RouteApiShow,this._RouteApiGenerate,this._RouteApiChat]&&n===404?new Ir(li.message,c):n===400?new tt(o.error,r,n,s):n===500?new tt(o.error,r,n):new tt(o.error,r,n)}async OllamaApiVersion(){let r=this._RouteApiVersion,n=`${this._server}${r}`,o={headers:this._headers,signal:this._signal};return(await de(n,o).then(c=>c.json()).then(c=>c).catch(c=>{throw this._ErrorLogger(c),c.type==="ECONNREFUSED"?ve:ci})).version}async OllamaApiTags(){let r=this._RouteApiTags,n=`${this._server}${r}`,o={headers:this._headers,signal:this._signal};return await de(n,o).then(async c=>{if(!c.ok){let u=await c.json();this._ErrorHandlerOllamaServer(r,c.status,u)}return c.json()}).then(c=>c).catch(c=>{throw this._ErrorLogger(c),c instanceof G&&c.type==="ECONNREFUSED"?ve:c})}async OllamaApiShow(r){let n=this._RouteApiShow,o=`${this._server}${n}`,c={method:"POST",headers:{"Content-Type":"application/json",...this._headers},body:JSON.stringify({name:r})};return await de(o,c).then(async d=>{if(!d.ok){let h=await d.json();this._ErrorHandlerOllamaServer(n,d.status,h,c,r)}return d.json()}).then(d=>d).catch(d=>{throw this._ErrorLogger(d),d instanceof G&&d.type==="ECONNREFUSED"?ve:d})}_OllamaApiShowParseModelfileFrom(r){let n=r.match(/^FROM[ ]+([a-zA-Z0-9:./]+)\n/m);return n?n[0]:""}_OllamaApiShowParseModelfileSystem(r){let n=r.search(/^SYSTEM[  ]+(.*)/m);if(n!==-1)return r.substring(n).split('"""')?.[1]}_OllamaApiShowParseModelfileLicense(r){let n=r.search(/^LICENSE[  ]+(.*)/m);if(n!==-1)return r.substring(n).split('"""')?.[1]}_OllamaApiShowParseModelfileParameterSplit(r){if(!r)return[];let n=r.split(`
`);return n||[]}_OllamaApiShowParseModelfileParameterMirostat(r){let n=r.filter(o=>o.search(/^mirostat[  ]+(.*)/m)!==-1).map(o=>o.match(/^mirostat[  ]+(.*)/m)?.[1])?.[0];return n?Number(n):0}_OllamaApiShowParseModelfileParameterMirostatEta(r){let n=r.filter(o=>o.search(/^mirostat_eta[  ]+(.*)/m)!==-1).map(o=>o.match(/^mirostat_eta[  ]+(.*)/m)?.[1])?.[0];return n?Number(n):.1}_OllamaApiShowParseModelfileParameterMirostatTau(r){let n=r.filter(o=>o.search(/^mirostat_tau[  ]+(.*)/m)!==-1).map(o=>o.match(/^mirostat_tau[  ]+(.*)/m)?.[1])?.[0];return n?Number(n):5}_OllamaApiShowParseModelfileParameterNumCtx(r){let n=r.filter(o=>o.search(/^num_ctx[  ]+(.*)/m)!==-1).map(o=>o.match(/^num_ctx[  ]+(.*)/m)?.[1])?.[0];return n?Number(n):2048}_OllamaApiShowParseModelfileParameterNumGqa(r){let n=r.filter(o=>o.search(/^num_gqa[  ]+(.*)/m)!==-1).map(o=>o.match(/^num_gqa[  ]+(.*)/m)?.[1])?.[0];if(n)return Number(n)}_OllamaApiShowParseModelfileParameterNumGpu(r){let n=r.filter(o=>o.search(/^num_gpu[  ]+(.*)/m)!==-1).map(o=>o.match(/^num_gpu[  ]+(.*)/m)?.[1])?.[0];return n?Number(n):1}_OllamaApiShowParseModelfileParameterNumThread(r){let n=r.filter(o=>o.search(/^num_thread[  ]+(.*)/m)!==-1).map(o=>o.match(/^num_thread[  ]+(.*)/m)?.[1])?.[0];if(n)return Number(n)}_OllamaApiShowParseModelfileParameterRepeatLastN(r){let n=r.filter(o=>o.search(/^repeat_last_n[  ]+(.*)/m)!==-1).map(o=>o.match(/^repeat_last_n[  ]+(.*)/m)?.[1])?.[0];return n?Number(n):64}_OllamaApiShowParseModelfileParameterRepeatPenalty(r){let n=r.filter(o=>o.search(/^repeat_penalty[  ]+(.*)/m)!==-1).map(o=>o.match(/^repeat_penalty[  ]+(.*)/m)?.[1])?.[0];return n?Number(n):1.1}_OllamaApiShowParseModelfileParameterTemperature(r){let n=r.filter(o=>o.search(/^temperature[  ]+(.*)/m)!==-1).map(o=>o.match(/^temperature[  ]+(.*)/m)?.[1])?.[0];return n?Number(n):.8}_OllamaApiShowParseModelfileParameterSeed(r){let n=r.filter(o=>o.search(/^seed[  ]+(.*)/m)!==-1).map(o=>o.match(/^seed[  ]+(.*)/m)?.[1])?.[0];return n?Number(n):0}_OllamaApiShowParseModelfileParameterStop(r){let n=r.filter(o=>o.search(/^stop[  ]+(.*)/m)!==-1).map(o=>o.match(/^stop[  ]+(.*)/m)?.[1]);return n||[]}_OllamaApiShowParseModelfileParameterTfsZ(r){let n=r.filter(o=>o.search(/^tfs_z[  ]+(.*)/m)!==-1).map(o=>o.match(/^tfs_z[  ]+(.*)/m)?.[1])?.[0];return n?Number(n):1}_OllamaApiShowParseModelfileParameterNumPredict(r){let n=r.filter(o=>o.search(/^num_predict[  ]+(.*)/m)!==-1).map(o=>o.match(/^num_predict[  ]+(.*)/m)?.[1])?.[0];return n?Number(n):128}_OllamaApiShowParseModelfileParameterTopK(r){let n=r.filter(o=>o.search(/^top_k[  ]+(.*)/m)!==-1).map(o=>o.match(/^top_k[  ]+(.*)/m)?.[1])?.[0];return n?Number(n):40}_OllamaApiShowParseModelfileParameterTopP(r){let n=r.filter(o=>o.search(/^top_p[  ]+(.*)/m)!==-1).map(o=>o.match(/^top_p[  ]+(.*)/m)?.[1])?.[0];return n?Number(n):.9}_OllamaApiShowParseModelfileParameterAdapter(r){let n=r.filter(o=>o.search(/^ADAPTER[  ]+(.*)/m)!==-1).map(o=>o.match(/^ADAPTER[  ]+(.*)/m)?.[1])?.[0];if(n)return n}OllamaApiShowParseModelfile(r){let n=this._OllamaApiShowParseModelfileParameterSplit(r.parameters);return{from:r.template&&this._OllamaApiShowParseModelfileFrom(r.template),parameter:{mirostat:n.length>0?this._OllamaApiShowParseModelfileParameterMirostat(n):0,mirostat_eta:n.length>0?this._OllamaApiShowParseModelfileParameterMirostatEta(n):.1,mirostat_tau:n.length>0?this._OllamaApiShowParseModelfileParameterMirostatTau(n):5,num_ctx:n.length>0?this._OllamaApiShowParseModelfileParameterNumCtx(n):2048,num_gqa:n.length>0?this._OllamaApiShowParseModelfileParameterNumGqa(n):void 0,num_gpu:n.length>0?this._OllamaApiShowParseModelfileParameterNumGpu(n):1,num_thread:n.length>0?this._OllamaApiShowParseModelfileParameterNumThread(n):void 0,repeat_last_n:n.length>0?this._OllamaApiShowParseModelfileParameterRepeatLastN(n):64,repeat_penalty:n.length>0?this._OllamaApiShowParseModelfileParameterRepeatPenalty(n):1.1,temperature:n.length>0?this._OllamaApiShowParseModelfileParameterTemperature(n):.8,seed:n.length>0?this._OllamaApiShowParseModelfileParameterSeed(n):0,stop:n.length>0?this._OllamaApiShowParseModelfileParameterStop(n):[],tfs_z:n.length>0?this._OllamaApiShowParseModelfileParameterTfsZ(n):1,num_predict:n.length>0?this._OllamaApiShowParseModelfileParameterNumPredict(n):128,top_k:n.length>0?this._OllamaApiShowParseModelfileParameterTopK(n):40,top_p:n.length>0?this._OllamaApiShowParseModelfileParameterTopP(n):.9},template:r.template,system:r.template&&this._OllamaApiShowParseModelfileSystem(r.template),adapter:this._OllamaApiShowParseModelfileParameterAdapter(n),license:r.template&&this._OllamaApiShowParseModelfileLicense(r.template)}}async OllamaApiDelete(r){let n=this._RouteApiDelete,o=`${this._server}${n}`,c={method:"DELETE",headers:{"Content-Type":"application/json",...this._headers},body:JSON.stringify({model:r})};await de(o,c).then(async u=>{if(!u.ok){let d=await u.json();this._ErrorHandlerOllamaServer(n,u.status,d,c,r)}}).catch(u=>{throw this._ErrorLogger(u),u instanceof G&&u.type==="ECONNREFUSED"?ve:u})}async OllamaApiPull(r){let n=this._RouteApiPull,o=`${this._server}${n}`,s={method:"POST",headers:this._headers,body:JSON.stringify({name:r})},c;for(;c===void 0;)c=await de(o,s).then(async u=>{if(!u.ok){let d=await u.json();this._ErrorHandlerOllamaServer(n,u.status,d,s,r)}return u.body}).then(u=>{if(u===void 0)return;let d=new Ln.EventEmitter;return u?.on("data",h=>{if(h!==void 0){let m,A=Buffer.from(h);try{m=JSON.parse(A.toString())}catch(E){console.error(E)}m&&("total"in m&&m.total&&"completed"in m&&m.completed?d.emit("downloading",m.completed/m.total):"status"in m&&m.status==="success"?d.emit("done","Download completed"):"error"in m?d.emit("error",m.error):d.emit("message",m.status))}}),d}).catch(u=>{throw this._ErrorLogger(u),u instanceof G&&u.type==="ECONNREFUSED"?ve:u});return c}async _OllamaApiStream(r,n,o){let s=`${this._server}${r}`,c={method:"POST",headers:this._headers,body:JSON.stringify(n)},u;for(;u===void 0;){let d="";u=await de(s,c).then(async h=>{if(!h.ok){let m=await h.json();this._ErrorHandlerOllamaServer(r,h.status,m,c,n.model)}return h.body}).then(h=>{if(h===void 0)return;let m=new Ln.EventEmitter,A=E=>{if(E)if("done"in E)if(E.done)m.emit("done",E);else{let _=o(E);_&&m.emit("data",_)}else"error"in E&&E.error&&m.emit("error",E)};return h?.on("data",E=>{if(E!==void 0){let y=Buffer.from(E).toString();d!==""&&(y=d+y);for(let g of y.split(`
`).filter(S=>S!==""))try{let S=JSON.parse(g);A(S),d=""}catch(S){console.error(S),d+=g}}}),m}).catch(h=>{throw this._ErrorLogger(h),h instanceof G&&h.type==="ECONNREFUSED"?ve:h})}return u}async OllamaApiGenerate(r){return await this._OllamaApiStream(this._RouteApiGenerate,r,n=>{if(n&&"response"in n&&n.response)return n.response})}async OllamaApiGenerateNoStream(r){return await this._OllamaApiNoStream(this._RouteApiGenerate,r)}async OllamaApiChat(r){return await this._OllamaApiStream(this._RouteApiChat,r,n=>{if(n&&"message"in n&&n.message)return n.message.content})}async OllamaApiChatNoStream(r){return await this._OllamaApiNoStream(this._RouteApiChat,r)}async _OllamaApiNoStream(r,n){n.stream=!1;let o=`${this._server}${r}`,s={method:"POST",headers:this._headers,body:JSON.stringify(n)};return await de(o,s).then(async u=>{if(!u.ok){let d=await u.json();this._ErrorHandlerOllamaServer(r,u.status,d,s,n.model)}return u.json()}).then(u=>u).catch(u=>{throw this._ErrorLogger(u),u instanceof G&&u.type==="ECONNREFUSED"?ve:u})}async OllamaApiEmbeddings(r,n){let o=this._RouteApiEmbeddings,s=`${this._server}${o}`,c={method:"POST",headers:this._headers,body:JSON.stringify({model:n,prompt:r})},u;for(;u===void 0;)u=await de(s,c).then(async d=>{if(!d.ok){let h=await d.json();this._ErrorHandlerOllamaServer(o,d.status,h,c,n)}return d.json()}).then(async d=>{if(d!==void 0)return d}).catch(d=>{throw this._ErrorLogger(d),d instanceof G&&d.type==="ECONNREFUSED"?ve:d});return u}async OllamaApiPs(){let r=this._RouteApiPs,n=`${this._server}${r}`,o={method:"GET",headers:this._headers},s;for(;s===void 0;)s=await de(n,o).then(async c=>{if(!c.ok){let u=await c.json();this._ErrorHandlerOllamaServer(r,c.status,u,o)}return c.json()}).then(async c=>{if(c!==void 0)return c}).catch(c=>{throw this._ErrorLogger(c),c instanceof G&&c.type==="ECONNREFUSED"?ve:c});return s}};var Y=require("@raycast/api");var He=require("@raycast/api");var al=new Error("Raycast Need Accessibility Permission for This Feature. Enable it under macOS Settings > Privacy & Security > Accessibility."),il=new Error("Raycast Browser Extensions Needed for This Feature."),ol=new Error("Selected Text Not Found."),sl=new Error("Clipboard Text Not Found."),ll=new Error("Image Not Selected. At least one image need to be selected from Finder or in Clipboard.");async function qi(){let r=[...(await et()).keys()].sort(),n=r.filter(s=>s==="Local"),o=r.filter(s=>s!=="Local");return r.length>1?["All",...n,...o]:[...n,...o]}async function ji(){let a=new Map;return(await et()).forEach((n,o)=>a.set(o,new Et(n))),a}async function Fn(a){let r=await et();if(!r.has(a))throw new Error("Ollama Server Not Configured");return new Et(r.get(a))}async function Bn(a,r,n){await xr(a).then(async()=>{n("Local"),r(),await(0,Y.showToast)({style:Y.Toast.Style.Success,title:`Ollama Server '${a}' Deleted`})}).catch(async o=>{await(0,Y.showToast)({style:Y.Toast.Style.Failure,title:`Error Deleting Ollama Server '${a}'`,message:o})})}async function Vi(a){let r=[];if(a===void 0)return r;let n=await ji();return a!=="All"&&!n.has(a)?[]:(a!=="All"&&(n=new Map([[a,n.get(a)]])),(await Promise.all([...n.entries()].map(async o=>{let s=await o[1].OllamaApiTags().catch(async u=>{await(0,Y.showToast)({style:Y.Toast.Style.Failure,title:`'${o[0]}' Server`,message:u.message})}),c=await o[1].OllamaApiPs().catch(async u=>{await(0,Y.showToast)({style:Y.Toast.Style.Failure,title:`'${o[0]}' Server`,message:u.message})});return s?await Promise.all(s.models.map(async u=>{let d=await o[1].OllamaApiShow(u.name);return{server:{name:o[0],ollama:o[1]},detail:u,show:d,modelfile:o[1].OllamaApiShowParseModelfile(d),ps:c&&c.models.filter(h=>h.name===u.name)[0]}})):await Promise.resolve([])}))).forEach(o=>r=r.concat(o)),r)}async function Hi(a,r,n){let o=await Fn(a.server.name);await Un(o,a.server.name,a.detail.name,r,n)}async function Gi(a,r){await a.server.ollama.OllamaApiDelete(a.detail.name).then(async()=>{await(0,Y.showToast)({style:Y.Toast.Style.Success,title:`Model '${a.detail.name}' Deleted on '${a.server.name}' Server`}),r()}).catch(async n=>await(0,Y.showToast)({style:Y.Toast.Style.Failure,title:"Error",message:n}))}async function Un(a,r,n,o,s){let c=await a.OllamaApiPull(n).catch(async u=>{await(0,Y.showToast)({style:Y.Toast.Style.Failure,title:u.message})});c&&(c.on("message",async u=>{await(0,Y.showToast)({style:Y.Toast.Style.Animated,title:u})}),c.on("downloading",u=>{let d=u.toFixed(2);o(h=>{let m=h.findIndex(A=>A.server===r&&A.name===n);return m<0?(h.push({server:r,name:n,download:Number(d)}),[...h]):d!==h[m].download.toFixed(2)?(h[m].download=Number(d),[...h]):h})}),c.on("done",async()=>{o(u=>[...u.filter(h=>h.server!==r&&h.name!==n)]),s(),await(0,Y.showToast)({style:Y.Toast.Style.Success,title:`Model '${n}' Downloaded on '${r}' Server.`})}),c.on("error",async u=>{o(d=>(d.filter(h=>h.server!==r&&h.name!==n),[...d])),await(0,Y.showToast)({style:Y.Toast.Style.Failure,title:u})}))}var st=require("@raycast/api"),Me={New:st.Keyboard.Shortcut.Common.New,Edit:st.Keyboard.Shortcut.Common.Edit,Copy:st.Keyboard.Shortcut.Common.Copy,Remove:st.Keyboard.Shortcut.Common.Remove,CopyName:st.Keyboard.Shortcut.Common.CopyName,ToggleQuickLook:st.Keyboard.Shortcut.Common.ToggleQuickLook,AttachText:{macOS:{modifiers:["cmd"],key:"t"},Windows:{modifiers:["ctrl"],key:"t"}},AttachBrowserTab:{macOS:{modifiers:["cmd"],key:"b"},Windows:{modifiers:["ctrl"],key:"b"}},AttachImage:{macOS:{modifiers:["cmd"],key:"i"},Windows:{modifiers:["ctrl"],key:"i"}},ChangeModel:{macOS:{modifiers:["cmd"],key:"m"},Windows:{modifiers:["ctrl"],key:"m"}},UpdateModel:{macOS:{modifiers:["cmd"],key:"u"},Windows:{modifiers:["ctrl"],key:"u"}},OpenLibrary:{macOS:{modifiers:["cmd"],key:"l"},Windows:{modifiers:["ctrl"],key:"l"}}};var Yi=ie(require("react")),he=require("@raycast/api");var Le=require("react/jsx-runtime");function Ji(a){let[r,n]=Yi.useState(!1),{handleSubmit:o,itemProps:s}=Or({onSubmit(m){c(m)},initialValues:{server:a.selectedServer!=="All"?a.selectedServer:"Local"},validation:{server:Nt.Required,model:Nt.Required}});async function c(m){n(!0);let A=await Fn(m.server);await Un(A,m.server,m.model,a.setDownload,a.revalidate),a.setShow(!1),n(!1)}let u="Ollama Server Name",d="Model Tag",h=(0,Le.jsxs)(he.ActionPanel,{children:[!r&&(0,Le.jsx)(he.Action.SubmitForm,{onSubmit:o}),!r&&(0,Le.jsx)(he.Action,{title:"Close",icon:he.Icon.Xmark,onAction:()=>a.setShow(!1)})]});return(0,Le.jsxs)(he.Form,{actions:h,isLoading:r,children:[(0,Le.jsx)(he.Form.Dropdown,{title:"Server",info:u,...s.server,children:a.servers.map(m=>(0,Le.jsx)(he.Form.Dropdown.Item,{value:m,title:m}))}),(0,Le.jsx)(he.Form.TextField,{title:"Model",info:d,...s.model})]})}var K=require("@raycast/api");var ee=require("react/jsx-runtime");function Wn(a){let{handleSubmit:r,itemProps:n}=Or({onSubmit(S){d(S)},initialValues:{name:a.name?a.name:"",url:a.server?a.server.url:"http://127.0.0.1:11434",auth:a.server&&a.server.auth?a.server.auth.mode:"None",username:a.server&&a.server.auth&&a.server.auth.mode==="Basic"?a.server.auth.username:void 0,password:a.server&&a.server.auth&&a.server.auth.mode==="Basic"?a.server.auth.password:void 0,token:a.server&&a.server.auth&&a.server.auth.mode==="Bearer"?a.server.auth.token:void 0},validation:{name:o,url:s,auth:Nt.Required,username:c,password:c,token:u}});function o(S){if(!S)return"The item is required";if(S==="All"||S==="Local"||!a.name&&a.servers.find(O=>O===S))return"Name already in use"}function s(S){if(!S)return"The item is required";if(S.substring(S.length-1,S.length)==="/")return`The item shouldn't end with a "/" character.`;if(!S.match(/http(s)?:\/\/[a-z\d.:/]+/gim))return"The item must be a valid url"}function c(S){if(n.auth.value==="Basic"&&!S)return"The item is required"}function u(S){if(n.auth.value==="Bearer"&&!S)return"The item is required"}async function d(S){let O={url:S.url};S.auth!=="None"&&(O.auth={mode:S.auth,username:S.username,password:S.password,token:S.token}),a.name?a.name===S.name?await si(S.name,O):(await xr(a.name),await $n(S.name,O)):await $n(S.name,O),a.revalidate(),a.setShow(!1)}let h="Ollama Server Name",m="Ollama Server Url",A="Ollama Server Authentication Method",E="Ollama SServer Authentication Username",_="Ollama SServer Authentication Password",y="Ollama SServer Authentication Token",g=(0,ee.jsxs)(K.ActionPanel,{children:[(0,ee.jsx)(K.Action.SubmitForm,{onSubmit:r}),(0,ee.jsx)(K.Action,{title:"Close",icon:K.Icon.Xmark,onAction:()=>a.setShow(!1)})]});return(0,ee.jsxs)(K.Form,{actions:g,children:[(0,ee.jsx)(K.Form.TextField,{title:"Name",info:h,...n.name}),(0,ee.jsx)(K.Form.TextField,{title:"Model",info:m,...n.url}),(0,ee.jsxs)(K.Form.Dropdown,{title:"Authentication",info:A,...n.auth,children:[(0,ee.jsx)(K.Form.Dropdown.Item,{title:"None",value:"None"}),(0,ee.jsx)(K.Form.Dropdown.Item,{title:"Basic",value:"Basic"}),(0,ee.jsx)(K.Form.Dropdown.Item,{title:"Bearer",value:"Bearer"})]}),n.auth.value&&n.auth.value==="Basic"&&(0,ee.jsx)(K.Form.TextField,{title:"Username",info:E,...n.username}),n.auth.value&&n.auth.value==="Basic"&&(0,ee.jsx)(K.Form.PasswordField,{title:"Password",info:_,...n.password}),n.auth.value&&n.auth.value==="Bearer"&&(0,ee.jsx)(K.Form.PasswordField,{title:"Token",info:y,...n.token})]})}var $=require("react/jsx-runtime");function Qi(){let a=Se.useRef(new AbortController),{value:r,setValue:n,isLoading:o}=ii("ollama_server_selected","Local"),{data:s,isLoading:c,revalidate:u}=Wt(qi),{data:d,revalidate:h}=Wt(et),{data:m,isLoading:A,revalidate:E}=Wt(Vi,[r],{abortable:a}),[_,y]=Se.useState([]),[g,S]=Se.useState(!1);function O(){return(0,$.jsx)(w.List.Dropdown,{tooltip:"Available Server",onChange:n,defaultValue:r||"Local",children:s&&s.map(v=>(0,$.jsx)(w.List.Dropdown.Item,{title:v,value:v}))})}function P(v){return(0,$.jsx)(w.List.Item.Detail,{metadata:(0,$.jsxs)(w.List.Item.Detail.Metadata,{children:[(0,$.jsx)(w.List.Item.Detail.Metadata.Label,{title:"Format",text:v.model.detail.details.format}),(0,$.jsx)(w.List.Item.Detail.Metadata.Label,{title:"Family",text:v.model.detail.details.family}),v.model.show.capabilities&&v.model.show.capabilities.length>0&&(0,$.jsx)(w.List.Item.Detail.Metadata.TagList,{title:"Capabilities",children:v.model.show.capabilities.map(q=>(0,$.jsx)(w.List.Item.Detail.Metadata.TagList.Item,{text:q,color:w.Color.Purple}))}),v.model.detail.details.families&&v.model.detail.details.families.length>0&&(0,$.jsx)(w.List.Item.Detail.Metadata.TagList,{title:"Families",children:v.model.detail.details.families.map(q=>(0,$.jsx)(w.List.Item.Detail.Metadata.TagList.Item,{text:q}))}),(0,$.jsx)(w.List.Item.Detail.Metadata.Label,{title:"Parameter Size",text:v.model.detail.details.parameter_size}),(0,$.jsx)(w.List.Item.Detail.Metadata.Label,{title:"Quantization Level",text:v.model.detail.details.quantization_level}),(0,$.jsx)(w.List.Item.Detail.Metadata.Label,{title:"Modified At",icon:w.Icon.Calendar,text:v.model.detail.modified_at}),(0,$.jsx)(w.List.Item.Detail.Metadata.Label,{title:"Size",icon:w.Icon.HardDrive,text:`${(v.model.detail.size/1e9).toPrecision(2).toString()} GB`}),v.model.ps&&(0,$.jsx)(w.List.Item.Detail.Metadata.Label,{title:"Memory freed at",text:v.model.ps.expires_at}),(0,$.jsx)(w.List.Item.Detail.Metadata.Separator,{}),(0,$.jsx)(w.List.Item.Detail.Metadata.Label,{title:"System Prompt",text:v.model.show.system}),(0,$.jsx)(w.List.Item.Detail.Metadata.Label,{title:"Template",text:v.model.show.template}),(0,$.jsx)(w.List.Item.Detail.Metadata.Separator,{}),v.model.modelfile&&(0,$.jsx)(w.List.Item.Detail.Metadata.TagList,{title:"Parameters",children:Object.keys(v.model.modelfile.parameter).map((q,j)=>(0,$.jsx)(w.List.Item.Detail.Metadata.TagList.Item,{text:`${q} ${v.model.modelfile&&Object.values(v.model.modelfile?.parameter)[j]}`}))}),(0,$.jsx)(w.List.Item.Detail.Metadata.Separator,{}),(0,$.jsx)(w.List.Item.Detail.Metadata.Label,{title:"License",text:v.model.show.license})]})})}function T(v){return(0,$.jsxs)(w.ActionPanel,{children:[(0,$.jsxs)(w.ActionPanel.Section,{title:"Ollama Model",children:[(0,$.jsx)(w.Action,{title:g?"Hide Detail":"Show Detail",icon:g?w.Icon.EyeDisabled:w.Icon.Eye,onAction:()=>S(q=>!q),shortcut:Me.ToggleQuickLook}),(0,$.jsx)(w.Action.CopyToClipboard,{title:"Copy Model Name",content:v.model.detail.name,shortcut:Me.Copy}),(0,$.jsx)(w.Action,{title:"Update Model",icon:w.Icon.Repeat,onAction:()=>Hi(v.model,y,E),shortcut:Me.UpdateModel}),(0,$.jsx)(w.Action,{title:"Pull Model",icon:w.Icon.Download,onAction:()=>D(!0),shortcut:Me.New}),(0,$.jsxs)(w.ActionPanel.Submenu,{title:"Delete Model",icon:w.Icon.Trash,shortcut:Me.Remove,children:[(0,$.jsx)(w.Action,{title:`Yes, Delete "${v.model.detail.name}" Model`,icon:w.Icon.Trash,onAction:()=>Gi(v.model,E)}),(0,$.jsx)(w.Action,{title:"No",icon:w.Icon.XMarkCircle})]}),(0,$.jsx)(w.Action.OpenInBrowser,{title:"Models Library",icon:w.Icon.Globe,url:"https://ollama.com/library",shortcut:Me.OpenLibrary})]}),(0,$.jsxs)(w.ActionPanel.Section,{title:"Ollama Server",children:[(0,$.jsx)(w.Action,{title:"Add Server",icon:w.Icon.NewDocument,onAction:()=>te(!0)}),r!=="All"&&r!=="Local"&&(0,$.jsx)(w.Action,{title:"Edit Server",icon:w.Icon.Pencil,onAction:()=>Fe(!0)}),r!=="All"&&r!=="Local"&&r!==void 0&&(0,$.jsxs)(w.ActionPanel.Submenu,{title:"Delete Server",icon:w.Icon.DeleteDocument,children:[(0,$.jsx)(w.Action,{title:`Yes, Delete "${v.model.server.name}" Server`,icon:w.Icon.CheckCircle,onAction:()=>Bn(r,u,n)}),(0,$.jsx)(w.Action,{title:"No",icon:w.Icon.XMarkCircle})]})]})]})}function M(v,q){let j=[];return v==="All"&&j.push({tag:q.server.name,icon:w.Icon.HardDrive}),q.ps&&j.push({tag:{color:w.Color.Green,value:"In Memory"}}),j}Se.useEffect(()=>{!c&&r&&E()},[r,c]),Se.useEffect(()=>{!c&&s&&h()},[c,s]);let[C,D]=Se.useState(!1),[x,te]=Se.useState(!1),[Z,Fe]=Se.useState(!1);return s&&C?(0,$.jsx)(Ji,{setShow:D,setDownload:y,revalidate:E,servers:s.filter(v=>v!=="All"),selectedServer:r}):s&&x?(0,$.jsx)(Wn,{setShow:te,revalidate:u,servers:s}):s&&d&&Z?(0,$.jsx)(Wn,{setShow:Fe,revalidate:u,servers:s,server:d.get(r),name:r}):(0,$.jsxs)(w.List,{isLoading:o||A||c,isShowingDetail:g,searchBarAccessory:O(),actions:(0,$.jsxs)(w.ActionPanel,{children:[(0,$.jsxs)(w.ActionPanel.Section,{title:"Ollama Model",children:[(0,$.jsx)(w.Action,{title:"Pull Model",icon:w.Icon.Download,onAction:()=>D(!0),shortcut:Me.New}),(0,$.jsx)(w.Action.OpenInBrowser,{title:"Models Library",icon:w.Icon.Globe,url:"https://ollama.com/library",shortcut:Me.OpenLibrary})]}),(0,$.jsxs)(w.ActionPanel.Section,{title:"Ollama Server",children:[(0,$.jsx)(w.Action,{title:"Add Server",icon:w.Icon.NewDocument,onAction:()=>te(!0)}),r!=="All"&&r!=="Local"&&r!==void 0&&(0,$.jsx)(w.Action,{title:"Edit Server",icon:w.Icon.Pencil,onAction:()=>Fe(!0)}),r!=="All"&&r!=="Local"&&r!==void 0&&(0,$.jsx)(w.Action,{title:"Delete Server",icon:w.Icon.DeleteDocument,onAction:()=>Bn(r,u,n)})]})]}),children:[m&&m.length>0&&m.map(v=>(0,$.jsx)(w.List.Item,{title:v.detail.name,icon:w.Icon.Box,id:`${v.server.name}_${v.detail.name}`,actions:(0,$.jsx)(T,{model:v}),detail:(0,$.jsx)(P,{model:v}),accessories:M(r,v)},`${v.server.name}_${v.detail.name}`)),_.map(v=>{if(v.server===r||r==="All")return(0,$.jsx)(w.List.Item,{title:v.name,icon:oi(v.download),id:`${v.server}_${v.name}_download`,accessories:r==="All"?[{tag:v.server,icon:w.Icon.HardDrive}]:[]},`${v.server}_${v.name}_download`)}),(m===void 0||m.length===0)&&(_===void 0||_.length===0)&&(0,$.jsx)(w.List.EmptyView,{icon:w.Icon.Download,title:"No Models Installed.",description:"No model is currently installed on this server. You can download a new model using the \u2318+N (macOS) or ctrl+N (Windows) shortcut."})]})}process.env.NODE_TLS_REJECT_UNAUTHORIZED="0";function Ki(){return Qi()}
/*! Bundled license information:

fetch-blob/index.js:
  (*! fetch-blob. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)

formdata-polyfill/esm.min.js:
  (*! formdata-polyfill. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)

node-domexception/index.js:
  (*! node-domexception. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)
*/
