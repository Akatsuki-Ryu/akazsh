"use strict";var Ht=Object.create;var le=Object.defineProperty;var Gt=Object.getOwnPropertyDescriptor;var Kt=Object.getOwnPropertyNames;var Jt=Object.getPrototypeOf,Zt=Object.prototype.hasOwnProperty;var Yt=(e,r)=>{for(var t in r)le(e,t,{get:r[t],enumerable:!0})},Ke=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of Kt(r))!Zt.call(e,a)&&a!==t&&le(e,a,{get:()=>r[a],enumerable:!(n=Gt(r,a))||n.enumerable});return e};var E=(e,r,t)=>(t=e!=null?Ht(Jt(e)):{},Ke(r||!e||!e.__esModule?le(t,"default",{value:e,enumerable:!0}):t,e)),qt=e=>Ke(le({},"__esModule",{value:!0}),e);var Dr={};Yt(Dr,{default:()=>Mt});module.exports=qt(Dr);var se=require("react"),_=require("@raycast/api");var It=E(require("fs")),j=E(require("@raycast/api"));var p=E(require("react")),u=require("@raycast/api");var Je=Object.prototype.hasOwnProperty;function ue(e,r){var t,n;if(e===r)return!0;if(e&&r&&(t=e.constructor)===r.constructor){if(t===Date)return e.getTime()===r.getTime();if(t===RegExp)return e.toString()===r.toString();if(t===Array){if((n=e.length)===r.length)for(;n--&&ue(e[n],r[n]););return n===-1}if(!t||typeof e=="object"){n=0;for(t in e)if(Je.call(e,t)&&++n&&!Je.call(r,t)||!(t in r)||!ue(e[t],r[t]))return!1;return Object.keys(r).length===n}}return e!==e&&r!==r}var U=E(require("node:fs")),V=E(require("node:path")),tt=E(require("node:crypto")),de=E(require("node:child_process")),rt=require("node:buffer"),Q=E(require("node:stream")),nt=require("node:util"),A=require("node:fs/promises");var R=require("react/jsx-runtime"),me=E(require("node:os")),at=require("node:url"),Ce=globalThis;function Qt(e){let r=(0,p.useRef)(e),t=(0,p.useRef)(0);return ue(e,r.current)||(r.current=e,t.current+=1),(0,p.useMemo)(()=>r.current,[t.current])}function P(e){let r=(0,p.useRef)(e);return r.current=e,r}function ge(e,r){let t=e instanceof Error?e.message:String(e);return(0,u.showToast)({style:u.Toast.Style.Failure,title:r?.title??"Something went wrong",message:r?.message??t,primaryAction:r?.primaryAction??Ze(e),secondaryAction:r?.primaryAction?Ze(e):void 0})}var Ze=e=>{let r=!0,t="[Extension Name]...",n="";try{let o=JSON.parse((0,U.readFileSync)((0,V.join)(u.environment.assetsPath,"..","package.json"),"utf8"));t=`[${o.title}]...`,n=`https://raycast.com/${o.owner||o.author}/${o.name}`,(!o.owner||o.access==="public")&&(r=!1)}catch{}let a=u.environment.isDevelopment||r,s=e instanceof Error?e?.stack||e?.message||"":String(e);return{title:a?"Copy Logs":"Report Error",onAction(o){o.hide(),a?u.Clipboard.copy(s):(0,u.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(t)}&extension-url=${encodeURI(n)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${s}
\`\`\`
`)}`)}}};function be(e,r,t){let n=(0,p.useRef)(0),[a,s]=(0,p.useState)({isLoading:!0}),o=P(e),i=P(t?.abortable),c=P(r||[]),l=P(t?.onError),f=P(t?.onData),h=P(t?.onWillExecute),m=P(t?.failureToastOptions),k=P(a.data),y=(0,p.useRef)(null),d=(0,p.useRef)({page:0}),w=(0,p.useRef)(!1),O=(0,p.useRef)(!0),ie=(0,p.useRef)(50),S=(0,p.useCallback)(()=>(i.current&&(i.current.current?.abort(),i.current.current=new AbortController),++n.current),[i]),x=(0,p.useCallback)((...M)=>{let T=S();h.current?.(M),s(b=>({...b,isLoading:!0}));let Z=Xt(o.current)(...M);function Y(b){return b.name=="AbortError"||T===n.current&&(l.current?l.current(b):u.environment.launchType!==u.LaunchType.Background&&ge(b,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(B){B.hide(),y.current?.(...c.current||[])}},...m.current}),s({error:b,isLoading:!1})),b}return typeof Z=="function"?(w.current=!0,Z(d.current).then(({data:b,hasMore:B,cursor:jt})=>(T===n.current&&(d.current&&(d.current.cursor=jt,d.current.lastItem=b?.[b.length-1]),f.current&&f.current(b,d.current),B&&(ie.current=b.length),O.current=B,s(Bt=>d.current.page===0?{data:b,isLoading:!1}:{data:(Bt.data||[])?.concat(b),isLoading:!1})),b),b=>(O.current=!1,Y(b)))):(w.current=!1,Z.then(b=>(T===n.current&&(f.current&&f.current(b),s({data:b,isLoading:!1})),b),Y))},[f,l,c,o,s,y,h,d,m,S]);y.current=x;let F=(0,p.useCallback)(()=>{d.current={page:0};let M=c.current||[];return x(...M)},[x,c]),J=(0,p.useCallback)(async(M,T)=>{let Z;try{if(T?.optimisticUpdate){S(),typeof T?.rollbackOnError!="function"&&T?.rollbackOnError!==!1&&(Z=structuredClone(k.current?.value));let Y=T.optimisticUpdate;s(b=>({...b,data:Y(b.data)}))}return await M}catch(Y){if(typeof T?.rollbackOnError=="function"){let b=T.rollbackOnError;s(B=>({...B,data:b(B.data)}))}else T?.optimisticUpdate&&T?.rollbackOnError!==!1&&s(b=>({...b,data:Z}));throw Y}finally{T?.shouldRevalidateAfter!==!1&&(u.environment.launchType===u.LaunchType.Background||u.environment.commandMode==="menu-bar"?await F():F())}},[F,k,s,S]),ce=(0,p.useCallback)(()=>{d.current.page+=1;let M=c.current||[];x(...M)},[d,c,x]);(0,p.useEffect)(()=>{d.current={page:0},t?.execute!==!1?x(...r||[]):S()},[Qt([r,t?.execute,x]),i,d]),(0,p.useEffect)(()=>()=>{S()},[S]);let Wt=t?.execute!==!1?a.isLoading:!1,Vt={...a,isLoading:Wt},zt=w.current?{pageSize:ie.current,hasMore:O.current,onLoadMore:ce}:void 0;return{...Vt,revalidate:F,mutate:J,pagination:zt}}function Xt(e){return e===Promise.all||e===Promise.race||e===Promise.resolve||e===Promise.reject?e.bind(Promise):e}function Ye(e){return typeof e!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(e))!==null}function er(e){return e instanceof URLSearchParams?e.toString():e}function ot(e,r=[]){function t(n){return"update"in e?e.update(n,"utf8"):e.write(n)}return{dispatch:function(n){n=er(n),n===null?this._null():this["_"+typeof n](n)},_object:function(n){let a=/\[object (.*)\]/i,s=Object.prototype.toString.call(n),o=a.exec(s)?.[1]??"unknown:["+s+"]";o=o.toLowerCase();let i=null;if((i=r.indexOf(n))>=0){this.dispatch("[CIRCULAR:"+i+"]");return}else r.push(n);if(Buffer.isBuffer(n))return t("buffer:"),t(n.toString("utf8"));if(o!=="object"&&o!=="function"&&o!=="asyncfunction")if(this["_"+o])this["_"+o](n);else throw new Error('Unknown object type "'+o+'"');else{let c=Object.keys(n);c=c.sort(),Ye(n)||c.splice(0,0,"prototype","__proto__","constructor"),t("object:"+c.length+":");let l=this;return c.forEach(function(f){l.dispatch(f),t(":"),l.dispatch(n[f]),t(",")})}},_array:function(n,a){a=typeof a<"u"?a:!1;let s=this;if(t("array:"+n.length+":"),!a||n.length<=1){n.forEach(function(c){s.dispatch(c)});return}let o=[],i=n.map(function(c){let l=tr(),f=r.slice();return ot(l,f).dispatch(c),o=o.concat(f.slice(r.length)),l.read().toString()});r=r.concat(o),i.sort(),this._array(i,!1)},_date:function(n){t("date:"+n.toJSON())},_symbol:function(n){t("symbol:"+n.toString())},_error:function(n){t("error:"+n.toString())},_boolean:function(n){t("bool:"+n.toString())},_string:function(n){t("string:"+n.length+":"),t(n.toString())},_function:function(n){t("fn:"),Ye(n)?this.dispatch("[native]"):this.dispatch(n.toString()),this.dispatch("function-name:"+String(n.name)),this._object(n)},_number:function(n){t("number:"+n.toString())},_xml:function(n){t("xml:"+n.toString())},_null:function(){t("Null")},_undefined:function(){t("Undefined")},_regexp:function(n){t("regex:"+n.toString())},_uint8array:function(n){t("uint8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint8clampedarray:function(n){t("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(n))},_int8array:function(n){t("int8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint16array:function(n){t("uint16array:"),this.dispatch(Array.prototype.slice.call(n))},_int16array:function(n){t("int16array:"),this.dispatch(Array.prototype.slice.call(n))},_uint32array:function(n){t("uint32array:"),this.dispatch(Array.prototype.slice.call(n))},_int32array:function(n){t("int32array:"),this.dispatch(Array.prototype.slice.call(n))},_float32array:function(n){t("float32array:"),this.dispatch(Array.prototype.slice.call(n))},_float64array:function(n){t("float64array:"),this.dispatch(Array.prototype.slice.call(n))},_arraybuffer:function(n){t("arraybuffer:"),this.dispatch(new Uint8Array(n))},_url:function(n){t("url:"+n.toString())},_map:function(n){t("map:");let a=Array.from(n);this._array(a,!0)},_set:function(n){t("set:");let a=Array.from(n);this._array(a,!0)},_file:function(n){t("file:"),this.dispatch([n.name,n.size,n.type,n.lastModified])},_blob:function(){throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){t("domwindow")},_bigint:function(n){t("bigint:"+n.toString())},_process:function(){t("process")},_timer:function(){t("timer")},_pipe:function(){t("pipe")},_tcp:function(){t("tcp")},_udp:function(){t("udp")},_tty:function(){t("tty")},_statwatcher:function(){t("statwatcher")},_securecontext:function(){t("securecontext")},_connection:function(){t("connection")},_zlib:function(){t("zlib")},_context:function(){t("context")},_nodescript:function(){t("nodescript")},_httpparser:function(){t("httpparser")},_dataview:function(){t("dataview")},_signal:function(){t("signal")},_fsevent:function(){t("fsevent")},_tlswrap:function(){t("tlswrap")}}}function tr(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}function rr(e,r){let t=this[e];return t instanceof Date?`__raycast_cached_date__${t.toISOString()}`:Buffer.isBuffer(t)?`__raycast_cached_buffer__${t.toString("base64")}`:r}function nr(e,r){return typeof r=="string"&&r.startsWith("__raycast_cached_date__")?new Date(r.replace("__raycast_cached_date__","")):typeof r=="string"&&r.startsWith("__raycast_cached_buffer__")?Buffer.from(r.replace("__raycast_cached_buffer__",""),"base64"):r}function he(e){let r=tt.default.createHash("sha1");return ot(r).dispatch(e),r.digest("hex")}var ar=Symbol("cache without namespace"),qe=new Map;function L(e,r,t){let n=t?.cacheNamespace||ar,a=qe.get(n)||qe.set(n,new u.Cache({namespace:t?.cacheNamespace})).get(n);if(!a)throw new Error("Missing cache");let s=P(e),o=P(r),i=(0,p.useSyncExternalStore)(a.subscribe,()=>{try{return a.get(s.current)}catch(h){console.error("Could not get Cache data:",h);return}}),c=(0,p.useMemo)(()=>{if(typeof i<"u"){if(i==="undefined")return;try{return JSON.parse(i,nr)}catch(h){return console.warn("The cached data is corrupted",h),o.current}}else return o.current},[i,o]),l=P(c),f=(0,p.useCallback)(h=>{let m=typeof h=="function"?h(l.current):h;if(typeof m>"u")a.set(s.current,"undefined");else{let k=JSON.stringify(m,rr);a.set(s.current,k)}return m},[a,s,l]);return[c,f]}var q=Symbol();function st(e,r,t){let{initialData:n,keepPreviousData:a,internal_cacheKeySuffix:s,...o}=t||{},i=(0,p.useRef)(null),[c,l]=L(he(r||[])+s,q,{cacheNamespace:he(e)}),f=(0,p.useRef)(c!==q?c:n),h=(0,p.useRef)(void 0),{mutate:m,revalidate:k,...y}=be(e,r||[],{...o,onData(S,x){h.current=x,o.onData&&o.onData(S,x),!(x&&x.page>0)&&(i.current="promise",f.current=S,l(S))}}),d,w=y.pagination;h.current&&h.current.page>0&&y.data?d=y.data:i.current==="promise"?d=f.current:a&&c!==q?(d=c,w&&(w.hasMore=!0,w.pageSize=c.length)):a&&c===q?d=f.current:c!==q?(d=c,w&&(w.hasMore=!0,w.pageSize=c.length)):d=n;let O=P(d),ie=(0,p.useCallback)(async(S,x)=>{let F;try{if(x?.optimisticUpdate){typeof x?.rollbackOnError!="function"&&x?.rollbackOnError!==!1&&(F=structuredClone(O.current));let J=x.optimisticUpdate(O.current);i.current="cache",f.current=J,l(J)}return await m(S,{shouldRevalidateAfter:x?.shouldRevalidateAfter})}catch(J){if(typeof x?.rollbackOnError=="function"){let ce=x.rollbackOnError(O.current);i.current="cache",f.current=ce,l(ce)}else x?.optimisticUpdate&&x?.rollbackOnError!==!1&&(i.current="cache",f.current=F,l(F));throw J}},[l,m,O,f,i]);return(0,p.useEffect)(()=>{c!==q&&(i.current="cache",f.current=c)},[c]),{data:d,isLoading:y.isLoading,error:y.error,mutate:h.current&&h.current.page>0?m:ie,pagination:w,revalidate:k}}var fe=e=>!!e&&typeof e=="object"&&typeof e.removeListener=="function"&&typeof e.emit=="function"&&typeof e.reallyExit=="function"&&typeof e.listeners=="function"&&typeof e.kill=="function"&&typeof e.pid=="number"&&typeof e.on=="function",Re=Symbol.for("signal-exit emitter"),_e=class{constructor(){if(this.emitted={afterExit:!1,exit:!1},this.listeners={afterExit:[],exit:[]},this.count=0,this.id=Math.random(),Ce[Re])return Ce[Re];Object.defineProperty(Ce,Re,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(r,t){this.listeners[r].push(t)}removeListener(r,t){let n=this.listeners[r],a=n.indexOf(t);a!==-1&&(a===0&&n.length===1?n.length=0:n.splice(a,1))}emit(r,t,n){if(this.emitted[r])return!1;this.emitted[r]=!0;let a=!1;for(let s of this.listeners[r])a=s(t,n)===!0||a;return r==="exit"&&(a=this.emit("afterExit",t,n)||a),a}},Ie=class{onExit(){return()=>{}}load(){}unload(){}},Oe=class{#i;#t;#e;#o;#s;#a;#n;#r;constructor(r){this.#i=process.platform==="win32"?"SIGINT":"SIGHUP",this.#t=new _e,this.#a={},this.#n=!1,this.#r=[],this.#r.push("SIGHUP","SIGINT","SIGTERM"),globalThis.process.platform!=="win32"&&this.#r.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),globalThis.process.platform==="linux"&&this.#r.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT"),this.#e=r,this.#a={};for(let t of this.#r)this.#a[t]=()=>{let n=this.#e.listeners(t),{count:a}=this.#t,s=r;if(typeof s.__signal_exit_emitter__=="object"&&typeof s.__signal_exit_emitter__.count=="number"&&(a+=s.__signal_exit_emitter__.count),n.length===a){this.unload();let o=this.#t.emit("exit",null,t),i=t==="SIGHUP"?this.#i:t;o||r.kill(r.pid,i)}};this.#s=r.reallyExit,this.#o=r.emit}onExit(r,t){if(!fe(this.#e))return()=>{};this.#n===!1&&this.load();let n=t?.alwaysLast?"afterExit":"exit";return this.#t.on(n,r),()=>{this.#t.removeListener(n,r),this.#t.listeners.exit.length===0&&this.#t.listeners.afterExit.length===0&&this.unload()}}load(){if(!this.#n){this.#n=!0,this.#t.count+=1;for(let r of this.#r)try{let t=this.#a[r];t&&this.#e.on(r,t)}catch{}this.#e.emit=(r,...t)=>this.#l(r,...t),this.#e.reallyExit=r=>this.#c(r)}}unload(){this.#n&&(this.#n=!1,this.#r.forEach(r=>{let t=this.#a[r];if(!t)throw new Error("Listener not defined for signal: "+r);try{this.#e.removeListener(r,t)}catch{}}),this.#e.emit=this.#o,this.#e.reallyExit=this.#s,this.#t.count-=1)}#c(r){return fe(this.#e)?(this.#e.exitCode=r||0,this.#t.emit("exit",this.#e.exitCode,null),this.#s.call(this.#e,this.#e.exitCode)):0}#l(r,...t){let n=this.#o;if(r==="exit"&&fe(this.#e)){typeof t[0]=="number"&&(this.#e.exitCode=t[0]);let a=n.call(this.#e,r,...t);return this.#t.emit("exit",this.#e.exitCode,null),a}else return n.call(this.#e,r,...t)}},Ae=null,or=(e,r)=>(Ae||(Ae=fe(process)?new Oe(process):new Ie),Ae.onExit(e,r));function Le(e,{timeout:r}={}){let t=new Promise((i,c)=>{e.on("exit",(l,f)=>{i({exitCode:l,signal:f,timedOut:!1})}),e.on("error",l=>{c(l)}),e.stdin&&e.stdin.on("error",l=>{c(l)})}),n=or(()=>{e.kill()});if(r===0||r===void 0)return t.finally(()=>n());let a,s=new Promise((i,c)=>{a=setTimeout(()=>{e.kill("SIGTERM"),c(Object.assign(new Error("Timed out"),{timedOut:!0,signal:"SIGTERM"}))},r)}),o=t.finally(()=>{clearTimeout(a)});return Promise.race([s,o]).finally(()=>n())}var Ue=class extends Error{constructor(){super("The output is too big"),this.name="MaxBufferError"}};function sr(e){let{encoding:r}=e,t=r==="buffer",n=new Q.default.PassThrough({objectMode:!1});r&&r!=="buffer"&&n.setEncoding(r);let a=0,s=[];return n.on("data",o=>{s.push(o),a+=o.length}),n.getBufferedValue=()=>t?Buffer.concat(s,a):s.join(""),n.getBufferedLength=()=>a,n}async function Qe(e,r){let t=sr(r);return await new Promise((n,a)=>{let s=o=>{o&&t.getBufferedLength()<=rt.constants.MAX_LENGTH&&(o.bufferedData=t.getBufferedValue()),a(o)};(async()=>{try{await(0,nt.promisify)(Q.default.pipeline)(e,t),n()}catch(o){s(o)}})(),t.on("data",()=>{t.getBufferedLength()>8e7&&s(new Ue)})}),t.getBufferedValue()}async function Xe(e,r){e.destroy();try{return await r}catch(t){return t.bufferedData}}async function Ne({stdout:e,stderr:r},{encoding:t},n){let a=Qe(e,{encoding:t}),s=Qe(r,{encoding:t});try{return await Promise.all([n,a,s])}catch(o){return Promise.all([{error:o,exitCode:null,signal:o.signal,timedOut:o.timedOut||!1},Xe(e,a),Xe(r,s)])}}function ir(e){let r=typeof e=="string"?`
`:10,t=typeof e=="string"?"\r":13;return e[e.length-1]===r&&(e=e.slice(0,-1)),e[e.length-1]===t&&(e=e.slice(0,-1)),e}function et(e,r){return e.stripFinalNewline?ir(r):r}function cr({timedOut:e,timeout:r,signal:t,exitCode:n}){return e?`timed out after ${r} milliseconds`:t!=null?`was killed with ${t}`:n!=null?`failed with exit code ${n}`:"failed"}function lr({stdout:e,stderr:r,error:t,signal:n,exitCode:a,command:s,timedOut:o,options:i,parentError:c}){let f=`Command ${cr({timedOut:o,timeout:i?.timeout,signal:n,exitCode:a})}: ${s}`,h=t?`${f}
${t.message}`:f,m=[h,r,e].filter(Boolean).join(`
`);return t?t.originalMessage=t.message:t=c,t.message=m,t.shortMessage=h,t.command=s,t.exitCode=a,t.signal=n,t.stdout=e,t.stderr=r,"bufferedData"in t&&delete t.bufferedData,t}function ur({stdout:e,stderr:r,error:t,exitCode:n,signal:a,timedOut:s,command:o,options:i,parentError:c}){if(t||n!==0||a!==null)throw lr({error:t,exitCode:n,signal:a,stdout:e,stderr:r,command:o,timedOut:s,options:i,parentError:c});return e}var pe=class extends Error{constructor(r){super(r),this.name="PermissionError"}};function fr(e){return e instanceof Error&&e.name==="PermissionError"}async function dr(e,r,t){if(!(0,U.existsSync)(e))throw new Error("The database does not exist");let n;try{n=await(l=>import(l))("node:sqlite")}catch{return hr(e,r,t)}let a=new n.DatabaseSync(e,{open:!1,readOnly:!0}),s=t?.signal;try{a.open()}catch(c){if(console.log(c),c.message.match("(5)")||c.message.match("(14)")){let l;if(!l){let f=V.default.join(me.default.tmpdir(),"useSQL",he(e));await(0,A.mkdir)(f,{recursive:!0}),W(s),l=V.default.join(f,"db.db"),await(0,A.copyFile)(e,l),await(0,A.writeFile)(l+"-shm",""),await(0,A.writeFile)(l+"-wal",""),W(s)}a=new n.DatabaseSync(l,{open:!1,readOnly:!0}),a.open(),W(s)}}let o=a.prepare(r);W(s);let i=o.all();return a.close(),i}async function hr(e,r,t){let n=t?.signal,a=de.default.spawn("sqlite3",["--json","--readonly",e,r],{signal:n}),s=Le(a),[{error:o,exitCode:i,signal:c},l,f]=await Ne(a,{encoding:"utf-8"},s);if(W(n),f.match("(5)")||f.match("(14)")){let h;if(!h){let m=V.default.join(me.default.tmpdir(),"useSQL",he(e));await(0,A.mkdir)(m,{recursive:!0}),W(n),h=V.default.join(m,"db.db"),await(0,A.copyFile)(e,h),await(0,A.writeFile)(h+"-shm",""),await(0,A.writeFile)(h+"-wal",""),W(n)}a=de.default.spawn("sqlite3",["--json","--readonly","--vfs","unix-none",h,r],{signal:n}),s=Le(a),[{error:o,exitCode:i,signal:c},l,f]=await Ne(a,{encoding:"utf-8"},s),W(n)}if(o||i!==0||c!==null)throw f.includes("authorization denied")?new pe("You do not have permission to access the database."):new Error(f||"Unknown error");return JSON.parse(l.trim()||"[]")}function W(e){if(e?.aborted){let r=new Error("aborted");throw r.name="AbortError",r}}function it(e,r,t){let{permissionPriming:n,...a}=t||{},[s,o]=(0,p.useState)(null),i=P(t||{}),c=(0,p.useRef)(null),l=(0,p.useCallback)(h=>{console.error(h);let m=h instanceof Error&&h.message.includes("authorization denied")?new pe("You do not have permission to access the database."):h;fr(m)?o((0,R.jsx)(pr,{priming:i.current.permissionPriming})):i.current.onError?i.current.onError(m):u.environment.launchType!==u.LaunchType.Background&&ge(m,{title:"Cannot query the data"})},[i]),f=(0,p.useMemo)(()=>{if(!(0,U.existsSync)(e))throw new Error("The database does not exist");return async(h,m)=>{let k=c.current?.signal;return dr(h,m,{signal:k})}},[e]);return{...be(f,[e,r],{...a,onError:l}),permissionView:s}}function pr(e){let r=parseInt(me.default.release().split(".")[0])>=22,t=r?"Settings":"Preferences",n=r?{title:"Open System Settings -> Privacy",target:"x-apple.systempreferences:com.apple.preference.security?Privacy_AllFiles"}:{title:"Open System Preferences -> Security",target:"x-apple.systempreferences:com.apple.preference.security?Privacy_AllFiles"};return u.environment.commandMode==="menu-bar"?(0,R.jsxs)(u.MenuBarExtra,{icon:u.Icon.Warning,title:u.environment.commandName,children:[(0,R.jsx)(u.MenuBarExtra.Item,{title:"Raycast needs full disk access",tooltip:`You can revert this access in ${t} whenever you want`}),e.priming?(0,R.jsx)(u.MenuBarExtra.Item,{title:e.priming,tooltip:`You can revert this access in ${t} whenever you want`}):null,(0,R.jsx)(u.MenuBarExtra.Separator,{}),(0,R.jsx)(u.MenuBarExtra.Item,{title:n.title,onAction:()=>(0,u.open)(n.target)})]}):(0,R.jsx)(u.List,{children:(0,R.jsx)(u.List.EmptyView,{icon:{source:{light:"https://raycast.com/uploads/extensions-utils-security-permissions-light.png",dark:"https://raycast.com/uploads/extensions-utils-security-permissions-dark.png"}},title:"Raycast needs full disk access.",description:`${e.priming?e.priming+`
`:""}You can revert this access in ${t} whenever you want.`,actions:(0,R.jsx)(u.ActionPanel,{children:(0,R.jsx)(u.Action.Open,{...n})})})})}function ye(e,r){try{let t=o=>o.startsWith("http")?o:`https://${o}`,a=(typeof e=="string"?new at.URL(t(e)):e).hostname;switch(process.env.FAVICON_PROVIDER??"raycast"){case"none":return{source:r?.fallback??u.Icon.Link,mask:r?.mask};case"apple":return{source:r?.fallback??u.Icon.Link,mask:r?.mask};case"duckduckgo":case"duckDuckGo":return{source:`https://icons.duckduckgo.com/ip3/${a}.ico`,fallback:r?.fallback??u.Icon.Link,mask:r?.mask};case"google":return{source:`https://www.google.com/s2/favicons?sz=${r?.size??64}&domain=${a}`,fallback:r?.fallback??u.Icon.Link,mask:r?.mask};case"legacy":case"raycast":default:return{source:`https://api.ray.so/favicon?url=${a}&size=${r?.size??64}`,fallback:r?.fallback??u.Icon.Link,mask:r?.mask}}}catch(t){return console.error(t),u.Icon.Link}}async function ct(e,r,t){if(process.platform!=="darwin")throw new Error("AppleScript is only supported on macOS");let{humanReadableOutput:n,language:a,timeout:s,...o}=Array.isArray(r)?t||{}:r||{},i=n!==!1?[]:["-ss"];a==="JavaScript"&&i.push("-l","JavaScript"),Array.isArray(r)&&i.push("-",...r);let c=de.default.spawn("osascript",i,{...o,env:{PATH:"/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin"}}),l=Le(c,{timeout:s??1e4});c.stdin.end(e);let[{error:f,exitCode:h,signal:m,timedOut:k},y,d]=await Ne(c,{encoding:"utf8"},l),w=et({stripFinalNewline:!0},y),O=et({stripFinalNewline:!0},d);return ur({stdout:w,stderr:O,error:f,exitCode:h,signal:m,timedOut:k,command:"osascript",options:t,parentError:new Error})}var lt=E(require("node:fs")),ut=E(require("node:path")),H=require("@raycast/api"),ft=e=>{let r=!0,t="[Extension Name]...",n="";try{let o=JSON.parse(lt.readFileSync(ut.join(H.environment.assetsPath,"..","package.json"),"utf8"));t=`[${o.title}]...`,n=`https://raycast.com/${o.owner||o.author}/${o.name}`,(!o.owner||o.access==="public")&&(r=!1)}catch{}let a=H.environment.isDevelopment||r,s=e instanceof Error?e?.stack||e?.message||"":String(e);return{title:a?"Copy Logs":"Report Error",onAction(o){o.hide(),a?H.Clipboard.copy(s):(0,H.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(t)}&extension-url=${encodeURI(n)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${s}
\`\`\`
`)}`)}}};var te=require("react");var re=E(require("path"));var dt=E(require("fs"));var mr=()=>{try{let e=xe(),r=dt.default.readFileSync(e,"utf-8"),t=JSON.parse(r).profile.info_cache;return t?Object.keys(t)[0]:"Default"}catch{return"Default"}},ht=["Application Support","Google","Chrome"],pt=["Application Support","Google","Chrome","Local State"],I=mr(),G="CHROME_PROFILE_KEY",we="CHROME_PROFILES_KEY",mt=`
  # \u{1F6A8}Error: Google Chrome browser is not installed
  ## This extension depends on Google Chrome browser. You must install it to continue.

  If you have [Homebrew](https://brew.sh/) installed then press \u23CE (Enter Key) to install Google Chrome browser.

  [Click here](https://www.google.com/chrome/) if you want to download manually.

  [![Google Chrome](https://www.google.com/chrome/static/images/chrome-logo-m100.svg)]()
`;var gt=`
# \u{1F6A8}Error: Something happened while trying to run your command

[![Google Chrome](https://www.google.com/chrome/static/images/chrome-logo-m100.svg)]()
`,$e="An Error Occurred",ke="Google Chrome not installed";var bt=require("@raycast/api"),yt=()=>{if(!process.env.HOME)throw new Error("$HOME environment variable is not set.");return re.default.join(process.env.HOME,"Library")},gr=(e,r)=>{let{profilePath:t}=(0,bt.getPreferenceValues)(),n;return t?n=re.default.join(t,e):n=re.default.join(yt(),...ht,r??I,e),n},wt=e=>gr("History",e),xe=()=>re.default.join(yt(),...pt);var br=require("@raycast/api");var yr=require("react/jsx-runtime");var kt=require("react"),C=require("@raycast/api"),De=require("child_process");var xt=require("os"),vt=require("path"),ve=require("react/jsx-runtime"),wr=(()=>{try{return(0,De.execSync)("brew --prefix",{encoding:"utf8"}).trim()}catch{return(0,xt.cpus)()[0].model.includes("Apple")?"/opt/homebrew":"/usr/local"}})();function $t(){return(0,vt.join)(wr,"bin/brew")}function $r(e){try{return(0,De.execSync)(`${$t()} install --cask ${e}`,{maxBuffer:10*1024*1024})}catch(r){let t=r;throw t&&t.code===127?(t.stderr=`Brew executable not found at ${$t()}`,t):r}}function Ee(){let[e,r]=(0,kt.useState)(!0);return(0,ve.jsx)(C.Detail,{actions:(0,ve.jsx)(C.ActionPanel,{children:e&&(0,ve.jsx)(C.Action,{title:"Install with Homebrew",onAction:async()=>{if(!e)return;let t=new C.Toast({style:C.Toast.Style.Animated,title:"Installing..."});await t.show();try{$r("google-chrome"),await t.hide()}catch{await t.hide(),await(0,C.showToast)(C.Toast.Style.Failure,$e,"An unknown error occurred while trying to install")}t.title="Installed! Please go back and try again.",t.style=C.Toast.Style.Success,await t.show(),r(!1)}})}),markdown:mt})}var X=require("@raycast/api");var St=require("react/jsx-runtime");function Et(){return(0,X.showToast)(X.Toast.Style.Failure,$e,"Something happened while trying to run your command"),(0,St.jsx)(X.Detail,{markdown:gt})}var g=require("@raycast/api");var Tt=E(require("node:process"),1),Pt=require("node:util"),Fe=require("node:child_process"),kr=(0,Pt.promisify)(Fe.execFile);async function K(e,{humanReadableOutput:r=!0,signal:t}={}){if(Tt.default.platform!=="darwin")throw new Error("macOS only");let n=r?[]:["-ss"],a={};t&&(a.signal=t);let{stdout:s}=await kr("osascript",["-e",e,n],a);return s.trim()}var ee=require("@raycast/api");var z=class e{constructor(r,t,n,a,s,o){this.title=r;this.url=t;this.favicon=n;this.windowsId=a;this.tabIndex=s;this.sourceLine=o}static TAB_CONTENTS_SEPARATOR="~~~";static parse(r){let t=r.split(this.TAB_CONTENTS_SEPARATOR);return new e(t[0],t[1],t[2],+t[3],+t[4],r)}key(){return`${this.windowsId}${e.TAB_CONTENTS_SEPARATOR}${this.tabIndex}`}urlWithoutScheme(){try{return this.url.replace(/(^\w+:|^)\/\//,"").replace("www.","")}catch{return this.url}}realFavicon(){try{return new URL(this.favicon||"/favicon.ico",this.url).href}catch{return this.favicon||""}}googleFavicon(){try{return ye(this.url)}catch{return{source:""}}}};async function Ct(e){let r=e?`execute t javascript \xAC
        "document.head.querySelector('link[rel~=icon]') ? document.head.querySelector('link[rel~=icon]').href : '';"`:'""';await Se();try{return(await K(`
      set _output to ""
      tell application "Google Chrome"
        repeat with w in windows
          set _w_id to get id of w as inches as string
          set _tab_index to 1
          repeat with t in tabs of w
            set _title to get title of t
            set _url to get URL of t
            set _favicon to ${r}
            set _output to (_output & _title & "${z.TAB_CONTENTS_SEPARATOR}" & _url & "${z.TAB_CONTENTS_SEPARATOR}" & _favicon & "${z.TAB_CONTENTS_SEPARATOR}" & _w_id & "${z.TAB_CONTENTS_SEPARATOR}" & _tab_index & "\\n")
            set _tab_index to _tab_index + 1
          end repeat
        end repeat
      end tell
      return _output
  `)).split(`
`).filter(n=>n.length!==0).map(n=>z.parse(n))}catch(t){return t.message.includes(`Can't get application "Google Chrome"`)&&ee.LocalStorage.removeItem("is-installed"),await Se(),[]}}async function ne({url:e,query:r,profileCurrent:t,profileOriginal:n,openTabInProfile:a}){await Se();let s="",o=i=>`
    set profile to quoted form of "${i}"
    set link to quoted form of "${e||"about:blank"}"
    do shell script "open -na 'Google Chrome' --args --profile-directory=" & profile & " " & link
  `;switch(a){case"default":s=`
        set winExists to false
        tell application "Google Chrome"
            repeat with win in every window
                if index of win is 1 then
                    set winExists to true
                    exit repeat
                end if
            end repeat

            if not winExists then
                make new window
            else
                activate
            end if

            tell window 1
                set newTab to make new tab `+(e?`with properties {URL:"${e}"}`:r?'with properties {URL:"https://www.google.com/search?q='+r+'"}':"")+`
            end tell
        end tell
        return true

  `;break;case"profile_current":s=o(t);break;case"profile_original":s=o(n);break}try{return await ct(s),await(0,ee.popToRoot)({clearSearchBar:!0}),!0}catch(i){return await ge(i),!1}}async function Rt(e){await K(`
    tell application "Google Chrome"
      activate
      set _wnd to first window where id is ${e.windowsId}
      set index of _wnd to 1
      set active tab index of _wnd to ${e.tabIndex}
    end tell
    return true
  `)}async function At(e){await K(`
    tell application "Google Chrome"
      activate
      set _wnd to first window where id is ${e.windowsId}
      set index of _wnd to 1
      set active tab index of _wnd to ${e.tabIndex}
      close active tab of _wnd
    end tell
    return true
  `)}async function _t(e){await K(`
    tell application "Google Chrome"
      activate
      set _wnd to first window where id is ${e.windowsId}
      set index of _wnd to 1
      set active tab index of _wnd to ${e.tabIndex}
      tell active tab of _wnd to reload
    end tell
    return true
  `)}var Se=async()=>{if(await ee.LocalStorage.getItem("is-installed"))return;if(await K(`
set isInstalled to false
try
    do shell script "osascript -e 'exists application \\"Google Chrome\\"'"
    set isInstalled to true
end try

return isInstalled`)==="false")throw new Error(ke);ee.LocalStorage.setItem("is-installed",!0)};async function Me(e){await Se(),await K(`
    set link to quoted form of "${e}"
    do shell script "open -na 'Google Chrome' --args --guest " & link
  `)}var $=require("react/jsx-runtime"),N=class{static NewTab=vr;static TabList=Er;static TabHistory=Sr};function vr({query:e,url:r}){let{openTabInProfile:t}=(0,g.getPreferenceValues)(),[n]=L(G,I),a="Open Empty Tab";return e?a=`Search "${e}"`:r&&(a=`Open URL "${r}"`),(0,$.jsx)(g.ActionPanel,{title:"New Tab",children:(0,$.jsx)(g.Action,{onAction:()=>ne({url:r,query:e,profileCurrent:n,openTabInProfile:t}),title:a})})}function Er({tab:e,onTabClosed:r}){return(0,$.jsxs)(g.ActionPanel,{title:e.title,children:[(0,$.jsx)(Tr,{tab:e}),(0,$.jsx)(Cr,{tab:e}),(0,$.jsx)(g.Action,{title:"Open in Guest Window",icon:{source:g.Icon.Person},onAction:async()=>{try{await Me(e.url),await(0,g.closeMainWindow)()}catch(t){throw t instanceof Error?new Error(t.message):t}}}),(0,$.jsx)(g.Action.CopyToClipboard,{title:"Copy URL",content:e.url}),(0,$.jsx)(g.Action.CopyToClipboard,{title:"Copy Title",content:e.title,shortcut:{modifiers:["cmd","shift"],key:"enter"}}),(0,$.jsx)(Pr,{tab:e,onTabClosed:r}),(0,$.jsx)(g.ActionPanel.Section,{children:(0,$.jsx)(g.Action.CreateQuicklink,{quicklink:{link:e.url,name:e.title,application:"Google Chrome"},shortcut:{modifiers:["cmd"],key:"s"}})})]})}function Sr({title:e,url:r,profile:t}){let{openTabInProfile:n}=(0,g.getPreferenceValues)(),[a]=L(G,I);return(0,$.jsxs)(g.ActionPanel,{title:e,children:[(0,$.jsx)(g.Action,{onAction:()=>ne({url:r,profileOriginal:t,profileCurrent:a,openTabInProfile:n}),title:"Open"}),(0,$.jsx)(g.Action,{title:"Open in Guest Window",icon:{source:g.Icon.Person},onAction:async()=>{await Me(r),await(0,g.closeMainWindow)()}}),(0,$.jsxs)(g.ActionPanel.Section,{title:"Open in profile",children:[(0,$.jsx)(g.Action,{onAction:()=>ne({url:r,profileOriginal:t,profileCurrent:a,openTabInProfile:"profile_current"}),title:"Open in Current Profile"}),(0,$.jsx)(g.Action,{onAction:()=>ne({url:r,profileOriginal:t,profileCurrent:a,openTabInProfile:"profile_original"}),title:"Open in Original Profile"})]}),(0,$.jsx)(g.Action.CopyToClipboard,{title:"Copy URL",content:r,shortcut:{modifiers:["cmd"],key:"c"}})]})}function Tr(e){async function r(){try{await Rt(e.tab),await(0,g.closeMainWindow)()}catch(t){throw t instanceof Error?new Error("Issue with tab: '"+e.tab.sourceLine+`'
`+t.message):t}}return(0,$.jsx)(g.ActionPanel.Item,{title:"Open Tab",icon:{source:g.Icon.Eye},onAction:r})}function Pr(e){async function r(){await At(e.tab),await(0,g.closeMainWindow)(),e.onTabClosed?.()}return(0,$.jsx)(g.Action,{title:"Close Tab",icon:{source:g.Icon.XMarkCircle},onAction:r,shortcut:{modifiers:["cmd","shift"],key:"w"}})}function Cr(e){async function r(){try{await _t(e.tab),await(0,g.closeMainWindow)()}catch(t){throw t instanceof Error?new Error("Issue with tab: '"+e.tab.sourceLine+`'
`+t.message):t}}return(0,$.jsx)(g.Action,{title:"Reload Tab",icon:{source:g.Icon.ArrowClockwise},onAction:r,shortcut:{modifiers:["cmd","shift"],key:"r"}})}var D=require("@raycast/api");var oe=require("react/jsx-runtime"),ae=class{static TabList=_r;static TabHistory=Ar};function Rr(e){let r=["javascript:","data:","about:","chrome:","file:"],t=e.toLowerCase().trim();if(r.some(n=>t.startsWith(n)))return{icon:{source:D.Icon.ExclamationMark,tintColor:D.Color.Orange},isInvalid:!0};try{return new URL(e),{icon:ye(e),isInvalid:!1}}catch{return{icon:{source:D.Icon.ExclamationMark,tintColor:D.Color.Orange},isInvalid:!0}}}function Ar({profile:e,entry:{url:r,title:t,id:n},type:a}){let{icon:s,isInvalid:o}=Rr(r);return(0,oe.jsx)(D.List.Item,{id:`${e}-${a}-${n}`,title:t,subtitle:r,icon:s,accessories:o?[{text:"\u26A0\uFE0F Invalid URL - Cannot open",tooltip:"This URL uses an unsupported protocol"}]:void 0,actions:(0,oe.jsx)(N.TabHistory,{title:t,url:r,profile:e})})}function _r(e){return(0,oe.jsx)(D.List.Item,{title:e.tab.title,subtitle:e.tab.urlWithoutScheme(),keywords:[e.tab.urlWithoutScheme()],actions:(0,oe.jsx)(N.TabList,{tab:e.tab,onTabClosed:e.onTabClosed}),icon:e.useOriginalFavicon?e.tab.realFavicon():e.tab.googleFavicon()})}function Te(e){if(!e)return{includeTerms:[],excludeTerms:[]};let r=e.trim().split(/\s+/),t=[],n=[];for(let a of r)a.startsWith("\\-")&&a.length>1?t.push(a.slice(1).toLowerCase()):a.startsWith("-")&&a.length>1?n.push(a.slice(1).toLowerCase()):a.length>0&&a!=="-"&&t.push(a.toLowerCase());return{includeTerms:t,excludeTerms:n}}function We(e,r){let{includeTerms:t,excludeTerms:n}=r,a=t.length===0||t.every(o=>e.includes(o)),s=n.length===0||!n.some(o=>e.includes(o));return a&&s}var Lt=require("react/jsx-runtime"),Ir=(e,r,t)=>{let n=i=>i.replace(/'/g,"''"),a=r.map(i=>`(${e}.title LIKE '%${n(i)}%' OR ${e}.url LIKE '%${n(i)}%')`),s=t.map(i=>`NOT (${e}.title LIKE '%${n(i)}%' OR ${e}.url LIKE '%${n(i)}%')`),o=[...a,...s];return o.length>0?o.join(" AND "):"1=1"},Or=(e,r,t,n)=>`SELECT id,
            url,
            title,
            datetime(${r} /
                     1000000 +
                     (strftime('%s', '1601-01-01')),
                     'unixepoch',
                     'localtime') as lastVisited
     FROM ${e}
     WHERE ${Ir(e,t,n)}
     AND last_visit_time > 0
     ORDER BY ${r} DESC LIMIT 30;`,Lr=(e,r)=>{let t=Te(r||""),n=Or("urls","last_visit_time",t.includeTerms,t.excludeTerms),a=wt(e);if(!It.existsSync(a))return{isLoading:!1,data:[],errorView:(0,Lt.jsx)(Ee,{})};let[s,o]=(0,te.useState)(!1),[i,c]=(0,te.useState)(0),[l,f]=(0,te.useState)(null);(0,te.useEffect)(()=>()=>{l&&clearTimeout(l)},[l]);let{data:h,isLoading:m,permissionView:k,revalidate:y}=it(a,n,{onData(){o(!1),c(0),f(null)},onError(d){if(i<1){o(!0),c(i+1);let w=setTimeout(()=>{y(),clearTimeout(w)},1e3);f(w)}else o(!1),c(0),f(null),j.environment.launchType!==j.LaunchType.Background&&j.showToast({style:j.Toast.Style.Failure,title:"Failed to load history",message:d.message,primaryAction:ft(d)})}});return{data:h,isLoading:m||s,errorView:k,revalidate:y}};function Ot(e,r){return Lr(e,r)}var Ve=require("react");var Ut=require("@raycast/api");var ze=require("react/jsx-runtime");function Nt(e=""){let{useOriginalFavicon:r}=(0,Ut.getPreferenceValues)(),[t,n]=(0,Ve.useState)(),[a,s]=(0,Ve.useState)(!1),{isLoading:o,data:i}=be(async(l,f)=>{let h=await Ct(l),m=Te(f);return n(void 0),s(h.length===0),m.includeTerms.length===0&&m.excludeTerms.length===0?h:h.filter(k=>{try{let y=`${k.title.toLowerCase()} ${k.urlWithoutScheme().toLowerCase()}`;return We(y,m)}catch{let y=`${k.title.toLowerCase()} ${k.url.toLowerCase()}`;return We(y,m)}})},[r,e],{onError(l){l.message===ke?n((0,ze.jsx)(Ee,{})):n((0,ze.jsx)(Et,{}))}});return{data:a?[]:i||[],isLoading:o,errorView:t}}var je=require("@raycast/api"),Be=require("react");var Pe=require("fs");var He=require("react/jsx-runtime");async function Ur(){let e=xe();if(!(0,Pe.existsSync)(e))return[{name:"Default",id:"Default"}];let r=await Pe.promises.readFile(e,"utf-8"),t=JSON.parse(r).profile.info_cache;return Object.entries(t).map(([n,a])=>({name:a.name,id:n}))}function Ge({onProfileSelected:e}){let[r,t]=L(G,I),[n,a]=L(we,[{name:"Person 1",id:I}]),{data:s}=st(Ur);return(0,Be.useEffect)(()=>{s&&(a(s),r||(s.length>0?t(s[0].id):t(I)))},[s]),(0,Be.useEffect)(()=>{r&&e?.(r)},[r]),!n||n.length<2?null:(0,He.jsx)(je.List.Dropdown,{tooltip:"Select Chrome Profile",value:r,onChange:t,children:n.map(o=>(0,He.jsx)(je.List.Dropdown.Item,{value:o.id,title:o.name},o.id))})}var Dt=require("url");function Ft(e){let r=e.trim();if(!r)return{type:"search",value:r};if(r.startsWith("http://")||r.startsWith("https://"))try{return new Dt.URL(r),{type:"url",value:r}}catch{return{type:"search",value:r}}if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(?::\d+)?$/.test(r))return{type:"url",value:`https://${r}`};if(/^localhost(?::\d+)?$/i.test(r))return{type:"url",value:`http://${r}`};if(r.includes(".")&&!/\s/.test(r)&&!r.endsWith(".")){let a=r.split("."),s=a[a.length-1],o=a[0];if(a.length>1&&s.length>=2&&o.length>0)return{type:"url",value:`https://${r}`}}return{type:"search",value:r}}var v=require("react/jsx-runtime");function Nr(e,r){if(!r||r.length===0)return[];let t=r.findIndex(n=>n?.profile?.id===e);if(t>0){let[n]=r.splice(t,1);r.unshift(n)}return r}function Mt(){let[e,r]=(0,se.useState)(),[t]=L(we),[n]=L(G,I),[a,s]=(0,se.useState)([]),o=Ot(n,e),{data:i,isLoading:c,errorView:l}=Nt(),{useOriginalFavicon:f}=(0,_.getPreferenceValues)();if((0,se.useEffect)(()=>{if(t&&n){let d=t.find(w=>w?.id===n);d&&o?s([{data:o.data,isLoading:o.isLoading,errorView:o.errorView,revalidate:o.revalidate,profile:d}]):(!o||!d)&&s([])}},[t,n,o.isLoading]),l||a?.some(d=>d.errorView)){let d=a?.find(w=>w.errorView)?.errorView;return l||d}let h=Ft(e||""),m,k,y;return h.value?h.type==="url"?(m=`Open URL "${e}"`,y=_.Icon.Globe,k=(0,v.jsx)(N.NewTab,{url:h.value})):(m=`Search "${e}"`,y=_.Icon.MagnifyingGlass,k=(0,v.jsx)(N.NewTab,{query:e})):(m="Open Empty Tab",y=_.Icon.Plus,k=(0,v.jsx)(N.NewTab,{})),(0,v.jsxs)(_.List,{onSearchTextChange:r,isLoading:c||a?.find(d=>d.isLoading)?.isLoading,searchBarAccessory:(0,v.jsx)(Ge,{}),children:[(0,v.jsx)(_.List.Section,{title:"New Tab",children:(0,v.jsx)(_.List.Item,{title:m,icon:y,actions:(0,v.jsx)(v.Fragment,{children:k})})},"new-tab"),(0,v.jsx)(_.List.Section,{title:"Open Tabs - All",children:i?.map(d=>(0,v.jsx)(ae.TabList,{tab:d,useOriginalFavicon:f},d.key()))},"open-tabs"),Nr(n,a).filter(d=>d?.profile?.id).map(d=>(0,v.jsx)(_.List.Section,{title:`History - ${d.profile.name}`,children:d.data?.map(w=>(0,v.jsx)(ae.TabHistory,{entry:w,profile:d.profile.id,type:"History"},`${d.profile.id}-${w.id}`))},d.profile.id))]})}
